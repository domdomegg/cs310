(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{2:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.typeUtils=t.ParseError=t.parse=t.PolyType=t.TypeFuncApp=t.TypeVar=t.Let=t.Abs=t.App=t.Var=t.NumberLiteral=t.CharLiteral=void 0;var a=n(29),o=function(){function e(e,t,n){this.value=e,this.pos=t,this.notes=n}return e.prototype.toString=function(){return"'"+this.value+"'"},e}();t.CharLiteral=o;var s=function(){function e(e,t,n){this.value=e,this.pos=t,this.notes=n}return e.prototype.toString=function(){return this.value.toString()},e}();t.NumberLiteral=s;var c=function(){function e(e,t,n){this.name=e,this.pos=t,this.notes=n}return e.prototype.toString=function(){return this.name},e}();t.Var=c;var u=function(){function e(e,t,n,r){this.func=e,this.arg=t,this.pos=n,this.notes=r}return e.prototype.toString=function(){return"("+this.func.toString()+" "+this.arg.toString()+")"},e}();t.App=u;var p=function(){function e(e,t,n,r){this.param=e,this.body=t,this.pos=n,this.notes=r}return e.prototype.toString=function(){return"(\\"+this.param+" -> "+this.body.toString()+")"},e}();t.Abs=p;var l=function(){function e(e,t,n,r,i){this.param=e,this.def=t,this.body=n,this.pos=r,this.notes=i}return e.prototype.toString=function(){return"(let "+this.param+" = "+this.def.toString()+" in "+this.body.toString()+")"},e}();t.Let=l;var h=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e}();t.TypeVar=h;var f=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.constructorName=e,this.args=t}return e.prototype.toString=function(){return"->"==this.constructorName?(this.args[0]instanceof e&&"->"==this.args[0].constructorName?"("+this.args[0].toString()+")":this.args[0].toString())+" -> "+this.args[1].toString():"[]"==this.constructorName?"["+this.args[0].toString()+"]":this.constructorName.startsWith(",")?"("+this.args.join(", ")+")":this.args.every((function(e){return e instanceof h||"Int"==e.constructorName||"Char"==e.constructorName||"Bool"==e.constructorName}))?this.constructorName+(this.args.length?" ":"")+this.args.map((function(e){return""+e.toString()})).join(" "):this.constructorName+(this.args.length?" ":"")+this.args.map((function(e){return"("+e.toString()+")"})).join(" ")},e}();t.TypeFuncApp=f;var d=function(){function e(e,t){this.quantifiedVars=e,this.monoType=t}return e.prototype.toString=function(){return(this.quantifiedVars.length?this.quantifiedVars.map((function(e){return"\u2200"+e})).join("")+": ":"")+this.monoType.toString()},e}();t.PolyType=d;var y=new f("Int"),w=new f("Char"),g=new f("Bool"),b=function e(t,n){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return 0===r.length?new f("->",t,n):new f("->",t,e.apply(void 0,i([n,r[0]],r.slice(1))))},m=function(e){return new f("[]",e)},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length<=1)throw new Error("Tuple has too few elements, minimum of 2 but given "+e.length);if(e.length>9)throw new Error("Tuple has too many elements, maximum of 9 but given "+e.length);return new(f.bind.apply(f,i([void 0,",".repeat(e.length-1)],e)))},j=function(e){return new f("Maybe",e)},O=function(e,t){return new f("Either",e,t)},x=new h("a"),T=new h("b"),S=new h("c"),F=new h("d"),A=function(e){return new d([],e)},C={"+":A(b(y,y,y)),"*":A(b(y,y,y)),"-":A(b(y,y,y)),"/":A(b(y,y,y)),"%":A(b(y,y,y)),negate:A(b(y,y)),abs:A(b(y,y)),signum:A(b(y,y)),even:A(b(y,g)),odd:A(b(y,g)),not:A(b(g,g)),"&&":A(b(g,g,g)),"||":A(b(g,g,g)),True:A(g),False:A(g),myNumber:A(y),myBoolean:A(g),"[]":new d(["a"],m(x)),":":new d(["a"],b(x,m(x),m(x))),cons:new d(["a"],b(x,m(x),m(x))),"++":new d(["a"],b(m(x),m(x),m(x))),head:new d(["a"],b(m(x),x)),last:new d(["a"],b(m(x),x)),tail:new d(["a"],b(m(x),m(x))),init:new d(["a"],b(m(x),m(x))),uncons:new d(["a"],b(m(x),j(v(x,m(x))))),null:new d(["a"],b(m(x),g)),length:new d(["a"],b(m(x),y)),map:new d(["a","b"],b(b(x,T),m(x),m(T))),reverse:new d(["a"],b(m(x),m(x))),intersperse:new d(["a"],b(x,m(x),m(x))),intercalate:new d(["a"],b(m(x),m(m(x)),m(x))),transpose:new d(["a"],b(m(m(x)),m(m(x)))),subsequences:new d(["a"],b(m(x),m(m(x)))),permutations:new d(["a"],b(m(x),m(m(x)))),foldl:new d(["a"],b(b(T,x,T),T,m(x),T)),"foldl'":new d(["a"],b(b(T,x,T),T,m(x),T)),foldl1:new d(["a"],b(b(x,x,x),m(x),x)),"foldl1'":new d(["a"],b(b(x,x,x),m(x),x)),foldr:new d(["a"],b(b(x,T,T),T,m(x),T)),foldr1:new d(["a"],b(b(x,x,x),m(x),x)),concat:new d(["a"],b(m(m(x)),m(x))),concatMap:new d(["a"],b(b(x,m(x)),m(x),m(T))),and:A(b(m(g),g)),or:A(b(m(g),g)),any:new d(["a"],b(b(x,g),m(x),g)),all:new d(["a"],b(b(x,g),m(x),g)),sum:A(b(m(y),y)),product:A(b(m(y),y)),maximum:A(b(m(y),y)),minimum:A(b(m(y),y)),take:new d(["a"],b(y,m(x),m(x))),drop:new d(["a"],b(y,m(x),m(x))),splitAt:new d(["a"],b(y,m(x),v(m(x),m(x)))),takeWhile:new d(["a"],b(b(x,g),m(x),m(x))),dropWhile:new d(["a"],b(b(x,g),m(x),m(x))),elem:new d(["a"],b(x,m(x),g)),notElem:new d(["a"],b(x,m(x),g)),lookup:new d(["a","b"],b(x,m(v(x,T)),j(T))),find:new d(["a"],b(b(x,g),m(x),j(x))),filter:new d(["a"],b(b(x,g),m(x),m(x))),partition:new d(["a"],b(b(x,g),m(x),v(m(x),m(x)))),"!!":new d(["a"],b(m(x),y,x)),zip:new d(["a","b"],b(m(x),m(T),m(v(x,T)))),zipWith:new d(["a","b","c"],b(b(x,T,S),m(x),m(T),m(S))),unzip:new d(["a","b"],b(m(v(x,T)),v(m(x),m(T)))),nub:new d(["a"],b(m(x),m(x))),delete:new d(["a"],b(x,m(x),m(x))),union:new d(["a"],b(m(x),m(x),m(x))),intersect:new d(["a"],b(m(x),m(x),m(x))),sort:new d(["a"],b(m(x),m(x))),",":new d(["a","b"],b(x,T,v(x,T))),",,":new d(["a","b","c"],b(x,T,S,v(x,T,S))),",,,":new d(["a","b","c","d"],b(x,T,S,F,v(x,T,S,F))),",,,,":new d(["a","b","c","d","e"],b(x,T,S,F,new h("e"),v(x,T,S,F,new h("e")))),",,,,,":new d(["a","b","c","d","e","f"],b(x,T,S,F,new h("e"),new h("f"),v(x,T,S,F,new h("e"),new h("f")))),",,,,,,":new d(["a","b","c","d","e","f","g"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),v(x,T,S,F,new h("e"),new h("f"),new h("g")))),",,,,,,,":new d(["a","b","c","d","e","f","g","h"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),v(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h")))),",,,,,,,,":new d(["a","b","c","d","e","f","g","h","i"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),new h("i"),v(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),new h("i")))),t:new d(["a","b"],b(x,T,v(x,T))),tt:new d(["a","b","c"],b(x,T,S,v(x,T,S))),ttt:new d(["a","b","c","d"],b(x,T,S,F,v(x,T,S,F))),tttt:new d(["a","b","c","d","e"],b(x,T,S,F,new h("e"),v(x,T,S,F,new h("e")))),ttttt:new d(["a","b","c","d","e","f"],b(x,T,S,F,new h("e"),new h("f"),v(x,T,S,F,new h("e"),new h("f")))),tttttt:new d(["a","b","c","d","e","f","g"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),v(x,T,S,F,new h("e"),new h("f"),new h("g")))),ttttttt:new d(["a","b","c","d","e","f","g","h"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),v(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h")))),tttttttt:new d(["a","b","c","d","e","f","g","h","i"],b(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),new h("i"),v(x,T,S,F,new h("e"),new h("f"),new h("g"),new h("h"),new h("i")))),fst:new d(["a","b"],b(v(x,T),x)),snd:new d(["a","b"],b(v(x,T),T)),curry:new d(["a","b","c"],b(b(v(x,T),S),x,T,S)),uncurry:new d(["a","b","c"],b(b(x,T,S),v(x,T),S)),Just:new d(["a"],b(x,j(x))),Nothing:new d(["a"],j(x)),Left:new d(["a","b"],b(x,O(x,T))),Right:new d(["a","b"],b(T,O(x,T))),id:new d(["a"],b(x,x))},k=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ParseError",n}return r(t,e),t}(Error);t.ParseError=k;var N=new a.GenLex,V=N.tokenize(a.C.charIn("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*+-/%<>^:_|&!'").rep().map((function(e){return e.join()})),"identifier"),P=N.tokenize(a.C.string("let "),"let"),_=N.tokenize(a.C.string("in "),"in"),E=N.tokenize(a.C.charLiteral(),"char"),I=N.tokenize(a.C.stringLiteral(),"string"),L=N.tokenize(a.N.integer(),"number"),W=N.tokenize(a.C.char("["),"lbracket"),z=N.tokenize(a.C.char("]"),"rbracket"),M=N.tokenize(a.C.char("\\"),"backslash"),q=N.tokenize(a.C.string("->"),"arrow"),H=N.tokenize(a.C.char("("),"lparen"),B=N.tokenize(a.C.char(")"),"rparen"),U=N.tokenize(a.C.char("="),"equal"),J=N.tokenize(a.C.char(","),"comma"),G=function(){return a.F.try(ie()).or(a.F.try(te())).or(a.F.try(R()))},R=function(){return a.F.try(ae($())).or(a.F.try(ae(ee()))).or(a.F.try(ae(re()))).or(a.F.try(ae(ne())))},D=function(){return a.F.try($()).or(a.F.try(ee())).or(a.F.try(re())).or(a.F.try(ne()))},K=function(e,t){for(var n=e.split(""),r=Y(t),i=new c("[]",{start:r.end-1,end:r.end}),a=n.length-1;a>=0;a--){var s={start:r.start+1+a,end:r.start+2+a};i=new u(new u(new c(":",s),new o(n[a],s),s),i,{start:r.start+1+a,end:r.end-1})}return i.pos.start=r.start,i.pos.end=r.end,i},Q=function(e){for(var t=e.first(),n=e.last(),r=e.at(1).map((function(e){return e.array()})).orElse([]),i={start:t,end:n},a=new c("[]",{start:i.end-1,end:i.end}),o=r.length-1;o>=0;o--)a=new u(new u(new c(":",r[o].pos),r[o],r[o].pos),a,{start:r[o].pos.start,end:i.end});return a.pos.start=i.start,a.pos.end=i.end,a},X=function(e){var t=e.first(),n=e.last(),r=e.at(1),a=se(i([new c(",".repeat(r.length-1),{start:t,end:t+1})],r));return a.pos.start=t,a.pos.end=n,a},Y=function(e){var t=e.getOffset()-1,n=e.input.location(t),r=e.input.location(t+1),i=e.input.source.input.source.slice(n,r);return{start:n,end:r-(i.length-i.trimEnd().length)}},Z=function(e,t){var n=t.input.source.input.source;return e.pos.end+=n.slice(e.pos.end).indexOf(")")+1,e.pos.start=n.slice(0,e.pos.start).lastIndexOf("("),e},$=function(){return a.F.try(L.map((function(e,t){return new s(e,Y(t))}))).or(a.F.try(I.map(K))).or(a.F.try(E.map((function(e,t){return new o(e,Y(t))})))).or(a.F.try(W.map((function(e,t){return t.location()-1})).then(a.F.lazy(G).then(J.drop().then(a.F.lazy(G)).optrep()).opt()).then(z.map((function(e,t){return Y(t).end}))).map(Q))).or(a.F.try(H.map((function(e,t){return t.location()-1})).then(a.F.lazy(G).then(J.drop().then(a.F.lazy(G)).rep()).array()).then(B.map((function(e,t){return Y(t).end}))).map(X))).or(a.F.try(V.map((function(e,t){return new c(e,Y(t))}))))},ee=function(){return H.drop().then(te()).then(B.drop()).single().map(Z)},te=function(){return M.map((function(e,t){return t.location()-1})).then(V).then(q.drop()).then(a.F.lazy(G)).map((function(e,t){return new p(e.at(1),e.at(2),{start:e.at(0),end:t.location()})}))},ne=function(){return H.drop().then(a.F.lazy(R)).then(B.drop()).single().map(Z)},re=function(){return H.drop().then(ie()).then(B.drop()).single().map(Z)},ie=function(){return P.map((function(e,t){return Y(t).start})).then(V).then(U.drop()).then(a.F.lazy(R)).then(_.drop()).then(a.F.lazy(R)).map((function(e,t){return new l(e.at(1),e.at(2),e.at(3),{start:e.at(0),end:t.location()})}))},ae=function(e){return e.then(oe()).array().map(se)},oe=function(){return a.F.lazy(D).optrep()},se=function(e){return e.reduce((function(e,t){return new u(e,t,{start:e.pos.start,end:t.pos.end})}))},ce=N.use(G().then(a.F.eos().drop()).single());t.parse=function(e,t){void 0===t&&(t=!1);var n=function(e){return"let"==e||e.endsWith(" let")?{accepted:!1,issuePosition:{start:e.length-3,end:e.length},message:"Failed to parse"}:"in"==e||e.endsWith(" in")?{accepted:!1,issuePosition:{start:e.length-2,end:e.length},message:"Failed to parse"}:void 0}(e);if(n){if(t)return n;throw new k("Failed to parse:\n\t"+e+"\n\t"+" ".repeat(n.issuePosition.start)+"^")}var r=ce.parse(a.Streams.ofString(e));if(t)return r.isAccepted()?{accepted:!0,value:r.value}:{accepted:!1,issuePosition:{start:r.location(),end:e.length},message:"Failed to parse"};if(r.isAccepted())return r.value;throw new k("Failed to parse:\n\t"+e+"\n\t"+" ".repeat(r.location())+"^")};var ue={number:y,char:w,boolean:g,f:b,list:m,tuple:v,maybe:j,either:O,a:x,b:T,c:S,d:F,pt:A,standardCtx:C};t.typeUtils=ue},20:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.apply=t.infer=t.unify=t.combine=t.substitute=t.TypeInferenceError=void 0;var o=n(2),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.name="TypeInferenceError",r.expr=n,r}return r(t,e),t}(Error);function c(e,t){var n=t,r={};for(var i in n)r[i]=b(n[i],e);return r}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return{};if(1===e.length)return e[0];if(e.length>2)return u(e[0],u.apply(void 0,e.slice(1)));var n=e[0],r=e[1],i={};for(var a in n)i[a]=b(n[a],r);for(var a in r)a in n||(i[a]=r[a]);return i}function p(e,t){var n;if(e instanceof o.TypeVar){if(t instanceof o.TypeVar&&e.name==t.name)return{};if(m(t,e))throw new s("Occurs check failed. `"+e.toString()+"` occurs in `"+t.toString()+"` so unifying them would create an infinite type.");return(n={})[e.name]=t,n}if(t instanceof o.TypeVar)return p(t,e);if(e instanceof o.TypeFuncApp&&t instanceof o.TypeFuncApp){if(e.constructorName!==t.constructorName)throw new s("Could not unify types `"+e.toString()+"` and `"+t.toString()+"` with different constructors `"+e.constructorName+"` and `"+t.constructorName+"`");if(e.args.length!==t.args.length)throw new s("Could not unify types `"+e.toString()+"` and `"+t.toString()+"` with different argument list lengths `"+e.args.length+"` and `"+t.args.length+"`");for(var r={},i=0;i<e.args.length;i++)r=u(r,p(b(e.args[i],r),b(t.args[i],r)));return r}throw new Error("Internal error, this should never happen")}function l(e,t){var n=new Set(t);return e.filter((function(e){return!n.has(e)}))}function h(e){if(e instanceof o.PolyType)return l(h(e.monoType),e.quantifiedVars);if(e instanceof o.TypeVar)return[e.name];if(e instanceof o.TypeFuncApp)return e.args.map(h).reduce((function(e,t){return a(e,t)}),[]);if(e)return Object.values(e).map(h).reduce((function(e,t){return a(e,t)}),[]);throw new Error("Internal error, this should never happen")}function f(e,t){return new o.PolyType(function(e){var t=[];return new Set(e).forEach((function(e){return t.push(e)})),t}(l(h(t),h(e))),t)}t.TypeInferenceError=s,t.substitute=c,t.combine=u,t.unify=p,t.infer=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=o.typeUtils.standardCtx);var r=0,i=function(){return"t"+r++};if(!t)return w(e,n,i)[0];var a=[];try{return{accepted:!0,value:{type:w(e,n,i,(function(t,n){a.push({message:t,ast:d(e,n)})}))[0],steps:a}}}catch(c){return{accepted:!1,value:{steps:a},issuePosition:c.name==s.name&&c.expr?c.expr.pos:e.pos,message:c.message}}};var d=function e(t,n){if(t instanceof o.CharLiteral)return new o.CharLiteral(t.value,t.pos,n.get(t));if(t instanceof o.NumberLiteral)return new o.NumberLiteral(t.value,t.pos,n.get(t));if(t instanceof o.Var)return new o.Var(t.name,t.pos,n.get(t));if(t instanceof o.App)return new o.App(e(t.func,n),e(t.arg,n),t.pos,n.get(t));if(t instanceof o.Abs)return new o.Abs(t.param,e(t.body,n),t.pos,n.get(t));if(t instanceof o.Let)return new o.Let(t.param,e(t.def,n),e(t.body,n),t.pos,n.get(t));throw new Error("Internal error, this should never happen")},y=function(e){var t=new Map;return t.set(e,"highlight"),t};function w(e,t,n,r){var a,l,h,d;if(void 0===r&&(r=function(){}),e instanceof o.CharLiteral)return r("We know the primitive `"+e.toString()+"` is a `Char`",y(e)),[g(new o.PolyType([],new o.TypeFuncApp("Char")),n),{}];if(e instanceof o.NumberLiteral)return r("We know the primitive `"+e.toString()+"` is an `Int`",y(e)),[g(new o.PolyType([],new o.TypeFuncApp("Int")),n),{}];if(e instanceof o.Var){var m;if(!(E=t[e.name]))throw r("We try to look up the variable `"+e.toString()+"` but find it is not in scope. We stop here as this is an error.",y(e)),new s("`"+e.name+"` is not in scope",e);var v=g(E,n);return r("We can look up the variable `"+e.toString()+"` and find it has type `"+E.toString()+"`"+(E.quantifiedVars.length?"\nWe instatiate this type with fresh type variables to get `"+v.toString()+"`":""),y(e)),[v,{}]}if(e instanceof o.App){var j=w(e.func,t,n,r),O=j[0],x=j[1],T=w(e.arg,c(x,t),n,r),S=T[0],F=T[1],A=new o.TypeVar(n()),C=O instanceof o.TypeFuncApp&&"->"==O.constructorName?"In function application, the function must accept the expected argument type.\nBefore unification, the function has type `"+O.toString()+"`\n\nTherefore we unify:\nFunction accepts `"+O.args[0].toString()+"`\nArgument has type `"+S.toString()+"`\n\n":"In function application, the function must accept the expected argument type and returns some other type.\n\nTherefore we unify:\nFunction type `"+O.toString()+"`\nArgument to fresh type `"+new o.TypeFuncApp("->",S,A).toString()+"`\n\n",k=void 0;try{k=p(b(O,F),new o.TypeFuncApp("->",S,A))}catch(m){throw r(C+"However, these two types are not unifiable. We stop here as this is an error.\n\nMore details:\n"+m.message,y(e)),m.expr=e,m}var N=b(A,k);return r(C+"This gives the substitution `"+(h=k,d=A.name,("{ "+Object.keys(h).filter((function(e){return e!==d})).map((function(e){return e+" \u21a6 "+h[e].toString()})).join(", ")+" }").replace("{  }","{}")+"`\nAnd the function's return type as `")+N.toString()+"`",y(e)),[N,u(x,F,k)]}if(e instanceof o.Abs){A=new o.TypeVar(n());r("Our function definition binds `"+e.param+"` in the body to the fresh type `"+A.toString()+"`",y(e));var V=w(e.body,i(i({},t),((a={})[e.param]=new o.PolyType([],A),a)),n,r),P=V[0],_=V[1],E=b(new o.TypeFuncApp("->",A,P),_);return r((_[A.name]?"We apply the substitution `{ "+A.name+" \u21a6 "+_[A.name].toString()+" }` to get the parameter's type `"+E.args[0].toString()+"`.\n":"")+"The return type is given by the function body's type `"+E.args[1].toString()+"`\nTherefore the overall type is `"+E.toString()+"`",y(e)),[E,_]}if(e instanceof o.Let){var I=w(e.def,t,n,r),L=I[0],W=I[1],z=f(c(W,t),L);r("Our let statement binds `"+e.param+"` in the body to the type `"+z.toString()+"`",y(e));var M=w(e.body,i(i({},c(W,t)),((l={})[e.param]=z,l)),n,r);P=M[0],_=M[1];return r("Our let statement then takes its body's type `"+P.toString()+"`",y(e)),[P,u(W,_)]}throw new Error("Internal error, this should never happen")}function g(e,t,n,r){if(void 0===n&&(n=[]),void 0===r&&(r=[]),e instanceof o.TypeVar){var i=n.indexOf(e.name);return-1===i?e:new o.TypeVar(r[i])}if(e instanceof o.TypeFuncApp)return new(o.TypeFuncApp.bind.apply(o.TypeFuncApp,a([void 0,e.constructorName],e.args.map((function(e){return g(e,t,n,r)})))));if(e instanceof o.PolyType)return g(e.monoType,t,e.quantifiedVars,e.quantifiedVars.map(t));throw new Error("Internal error, this should never happen")}function b(e,t){if(e instanceof o.TypeVar)return e.name in t?t[e.name]:e;if(e instanceof o.TypeFuncApp)return new(o.TypeFuncApp.bind.apply(o.TypeFuncApp,a([void 0,e.constructorName],e.args.map((function(e){return b(e,t)})))));if(e instanceof o.PolyType)return new o.PolyType(e.quantifiedVars,b(e.monoType,t));throw new Error("Internal error, this should never happen")}function m(e,t){if(e instanceof o.TypeVar)return e.name==t.name;if(e instanceof o.TypeFuncApp)return e.args.some((function(e){return m(e,t)}));if(e instanceof o.PolyType)return m(e.monoType,t)&&!e.quantifiedVars.includes(t.name);throw new Error("Internal error, this should never happen")}t.apply=b},21:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.apply=t.infer=t.unify=t.combine=t.substitute=t.TypeInferenceError=void 0;var o=n(2),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.name="TypeInferenceError",r.expr=n,r}return r(t,e),t}(Error);function c(e,t){var n=t,r={};for(var i in n)r[i]=m(n[i],e);return r}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return{};if(1===e.length)return e[0];if(e.length>2)return u(e[0],u.apply(void 0,e.slice(1)));var n=e[0],r=e[1],i={};for(var a in n)i[a]=m(n[a],r);for(var a in r)a in n||(i[a]=r[a]);return i}function p(e,t){var n;if(e instanceof o.TypeVar){if(t instanceof o.TypeVar&&e.name==t.name)return{};if(v(t,e))throw new s("Occurs check failed. `"+e.toString()+"` occurs in `"+t.toString()+"` so unifying them would create an infinite type.");return(n={})[e.name]=t,n}if(t instanceof o.TypeVar)return p(t,e);if(e instanceof o.TypeFuncApp&&t instanceof o.TypeFuncApp){if(e.constructorName!==t.constructorName)throw new s("Could not unify types `"+e.toString()+"` and `"+t.toString()+"` with different constructors `"+e.constructorName+"` and `"+t.constructorName+"`");if(e.args.length!==t.args.length)throw new s("Could not unify types `"+e.toString()+"` and `"+t.toString()+"` with different argument list lengths `"+e.args.length+"` and `"+t.args.length+"`");for(var r={},i=0;i<e.args.length;i++)r=u(r,p(m(e.args[i],r),m(t.args[i],r)));return r}throw new Error("Internal error, this should never happen")}function l(e,t){var n=new Set(t);return e.filter((function(e){return!n.has(e)}))}function h(e){if(e instanceof o.PolyType)return l(h(e.monoType),e.quantifiedVars);if(e instanceof o.TypeVar)return[e.name];if(e instanceof o.TypeFuncApp)return e.args.map(h).reduce((function(e,t){return a(e,t)}),[]);if(e)return Object.values(e).map(h).reduce((function(e,t){return a(e,t)}),[]);throw new Error("Internal error, this should never happen")}function f(e,t){return new o.PolyType(function(e){var t=[];return new Set(e).forEach((function(e){return t.push(e)})),t}(l(h(t),h(e))),t)}t.TypeInferenceError=s,t.substitute=c,t.combine=u,t.unify=p,t.infer=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=o.typeUtils.standardCtx);var r=0,i=function(){return"t"+r++},a=new o.TypeVar(i());if(!t)return(p=g(e,n,a,i))[a.name];var c=[],u=function(t,n){c.push({message:t,ast:d(e,n)})};u("We start algorithm M by assigning the root node a fresh type `"+a.toString()+"`",y(e));try{var p=g(e,n,a,i,u);return u("We can extract the root type `"+a.toString()+"` from the most recent substitution to get expression's type as `"+p[a.name].toString()+"`",y(e)),{accepted:!0,value:{type:p[a.name],steps:c}}}catch(l){return{accepted:!1,value:{steps:c},issuePosition:l.name==s.name&&l.expr?l.expr.pos:e.pos,message:l.message}}};var d=function e(t,n){if(t instanceof o.CharLiteral)return new o.CharLiteral(t.value,t.pos,n.get(t));if(t instanceof o.NumberLiteral)return new o.NumberLiteral(t.value,t.pos,n.get(t));if(t instanceof o.Var)return new o.Var(t.name,t.pos,n.get(t));if(t instanceof o.App)return new o.App(e(t.func,n),e(t.arg,n),t.pos,n.get(t));if(t instanceof o.Abs)return new o.Abs(t.param,e(t.body,n),t.pos,n.get(t));if(t instanceof o.Let)return new o.Let(t.param,e(t.def,n),e(t.body,n),t.pos,n.get(t));throw new Error("Internal error, this should never happen")},y=function(e){var t=new Map;return t.set(e,"highlight"),t},w=function(e,t){return("{ "+Object.keys(e).filter((function(e){return e!==t})).map((function(t){return t+" \u21a6 "+e[t].toString()})).join(", ")+" }").replace("{  }","{}")};function g(e,t,n,r,a){var l,h;if(void 0===a&&(a=function(){}),e instanceof o.CharLiteral){var d="We expect the type to unify with `"+n.toString()+"`, and we know the primitive `"+e.toString()+"` is a `Char`.";try{var v=p(n,b(new o.PolyType([],new o.TypeFuncApp("Char")),r));return a(d+"\nThese unify, giving the substitution `"+w(v)+"`",y(e)),v}catch(j){throw a(d+"\nHowever, these two types are not unifiable. We stop here as this is an error.\n\nMore details:\n"+j.message,y(e)),j.expr=e,j}}if(e instanceof o.NumberLiteral){d="We expect the type to unify with `"+n.toString()+"`, and we know the primitive `"+e.toString()+"` is an `Int`.";try{v=p(n,b(new o.PolyType([],new o.TypeFuncApp("Int")),r));return a(d+"\nThese unify, giving the substitution `"+w(v)+"`",y(e)),v}catch(j){throw a(d+"\nHowever, these two types are not unifiable. We stop here as this is an error.\n\nMore details:\n"+j.message,y(e)),j.expr=e,j}}if(e instanceof o.Var){var j,O=t[e.name];if(!O)throw a("We try to look up the variable `"+e.toString()+"` but find it is not in scope. We stop here as this is an error.",y(e)),new s("`"+e.name+"` is not in scope",e);var x=b(O,r);d="We expect this variable to unify with `"+n.toString()+"`\nWe look up the variable `"+e.toString()+"` and find it has type `"+O.toString()+"`"+(O.quantifiedVars.length?"\nWe instatiate this type with fresh type variables to get `"+x.toString()+"`":"");try{v=p(n,x);return a(d+"\nThese unify, giving the substitution `"+w(v)+"`",y(e)),v}catch(j){throw a(d+"\nHowever, these two types are not unifiable. We stop here as this is an error.\n\nMore details:\n"+j.message,y(e)),j.expr=e,j}}if(e instanceof o.App){var T=new o.TypeVar(r()),S=g(e.func,t,new o.TypeFuncApp("->",T,n),r,a),F=g(e.arg,c(S,t),m(T,S),r,a),A=(new o.TypeVar(r()),u(S,F));return a("As the argument unifies with the function definition the function application is valid, giving a combined substitution of `"+w(A)+"`",y(e)),A}if(e instanceof o.Abs){var C=new o.TypeVar(r()),k=new o.TypeVar(r()),N=new o.TypeFuncApp("->",C,k),V=(d="We expect this function definition to unify with a fresh function type `"+N.toString()+"` to unify with `"+n.toString()+"`",void 0);try{V=p(n,N),a(d+"\nThese unify, giving `"+w(V)+"`\nWe next will unify the body with `"+k.toString()+"`",y(e))}catch(j){throw a(d+"\nHowever, these two types are not unifiable. We stop here as this is an error.\n\nMore details:\n"+j.message,y(e)),j.expr=e,j}A=u(V,g(e.body,i(i({},c(V,t)),((l={})[e.param]=new o.PolyType([],m(C,V)),l)),m(k,V),r,a));return a("Combining the function and body substitutions gives `"+w(A)+"`",y(e)),A}if(e instanceof o.Let){a("We create a new type variable `"+(T=new o.TypeVar(r())).toString()+"` for this let statement's parameter `"+e.param+"`, then infer on the parameter and body",y(e));A=u(V=g(e.def,t,T,r,a),g(e.body,i(i({},c(V,t)),((h={})[e.param]=f(c(V,t),m(T,V)),h)),m(n,V),r,a));return a("Combining the parameter and body substitutions gives `"+w(A)+"`",y(e)),A}throw new Error("Internal error, this should never happen")}function b(e,t,n,r){if(void 0===n&&(n=[]),void 0===r&&(r=[]),e instanceof o.TypeVar){var i=n.indexOf(e.name);return-1===i?e:new o.TypeVar(r[i])}if(e instanceof o.TypeFuncApp)return new(o.TypeFuncApp.bind.apply(o.TypeFuncApp,a([void 0,e.constructorName],e.args.map((function(e){return b(e,t,n,r)})))));if(e instanceof o.PolyType)return b(e.monoType,t,e.quantifiedVars,e.quantifiedVars.map(t));throw new Error("Internal error, this should never happen")}function m(e,t){if(e instanceof o.TypeVar)return e.name in t?t[e.name]:e;if(e instanceof o.TypeFuncApp)return new(o.TypeFuncApp.bind.apply(o.TypeFuncApp,a([void 0,e.constructorName],e.args.map((function(e){return m(e,t)})))));if(e instanceof o.PolyType)return new o.PolyType(e.quantifiedVars,m(e.monoType,t));throw new Error("Internal error, this should never happen")}function v(e,t){if(e instanceof o.TypeVar)return e.name==t.name;if(e instanceof o.TypeFuncApp)return e.args.some((function(e){return v(e,t)}));if(e instanceof o.PolyType)return v(e.monoType,t)&&!e.quantifiedVars.includes(t.name);throw new Error("Internal error, this should never happen")}t.apply=m},28:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),a=n.n(i),o=n(19),s=n.n(o),c={analytics:{enabled:!0,url:"https://5lpondcp9g.execute-api.eu-west-1.amazonaws.com/"}},u=c.analytics.enabled&&"1"!==navigator.doNotTrack,p=Math.random().toString(36).slice(2),l=u?function(e){fetch(c.analytics.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:"cs310",streamId:p,data:e})})}:function(){},h=function(e,t){var n;return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];n&&clearTimeout(n),n=setTimeout((function(){n=void 0,e.apply(void 0,i)}),t)}}(l,1e3),f=l,d=n(3),y=(n(28),n(22)),w=n(2),g=n(20),b=n(21);function m(e){var t=e.node,n=e.hoverCallback;if(t instanceof w.CharLiteral||t instanceof w.NumberLiteral)return Object(r.jsx)(v,{node:t,hoverCallback:n,children:t.value});if(t instanceof w.Var)return Object(r.jsx)(v,{node:t,hoverCallback:n,children:t.name});if(t instanceof w.App)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(v,{node:t,hoverCallback:n,children:Object(r.jsx)("span",{className:"sans-serif",children:"Function application"})}),Object(r.jsx)(j,{children:Object(r.jsx)(m,{node:t.func,hoverCallback:n})}),Object(r.jsx)(j,{children:Object(r.jsx)(m,{node:t.arg,hoverCallback:n})})]});if(t instanceof w.Abs)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(v,{node:t,hoverCallback:n,children:["\u03bb",t.param]}),Object(r.jsx)(j,{symbol:"->",children:Object(r.jsx)(m,{node:t.body,hoverCallback:n})})]});if(t instanceof w.Let)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(v,{node:t,hoverCallback:n,children:["let ",t.param]}),Object(r.jsx)(j,{symbol:"=",children:Object(r.jsx)(m,{node:t.def,hoverCallback:n})}),Object(r.jsx)(j,{symbol:"in",children:Object(r.jsx)(m,{node:t.body,hoverCallback:n})})]});throw new Error("Attempted to display a node of invalid type "+typeof t)}function v(e){var t=e.children,n=e.node,i=e.hoverCallback;return Object(r.jsx)("div",{className:"ast-node "+(n.notes||""),onMouseOver:function(){return i(!0,n.pos)},onMouseOut:function(){return i(!1,n.pos)},children:t})}function j(e){var t=e.children,n=e.symbol;return Object(r.jsx)("div",{className:"ast-child","data-symbol":n,children:t})}var O=function(e){var t=e.ast,n=e.hoverCallback;return Object(r.jsx)("div",{className:"ast-view",children:Object(r.jsx)(m,{node:t,hoverCallback:n})})};var x=function(e,t){return function(n,r){e(n?[].concat(Object(y.a)(t),[{start:r.start,end:r.end,className:"highlight-white"}]):t)}},T=function(e){var t=e.code,n=e.algorithm,a=e.setHighlights,o=Object(w.parse)(t,!0);Object(i.useEffect)((function(){return a(o.accepted?[]:[{start:o.issuePosition.start,end:o.issuePosition.end,className:"highlight-error"}])}),[o,a]);var s="w"===n?g.infer:b.infer,c=o.accepted?s(o.value,!0):void 0;if(Object(i.useEffect)((function(){return c&&a(c.accepted?[]:[{start:c.issuePosition.start,end:c.issuePosition.end,className:"highlight-error"}])}),[c,a]),!o.accepted)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"Parse error"}),Object(r.jsx)("p",{children:o.message})]});var u=x(a,c.accepted?[]:[{start:c.issuePosition.start,end:c.issuePosition.end,className:"highlight-error"}]);return 0===c.value.steps.length&&(r.Fragment,o.value),Object(r.jsxs)(r.Fragment,{children:[c.accepted?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"Expression type"}),Object(r.jsx)("p",{children:Object(r.jsx)("code",{children:c.value.type.toString()})})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"Type error"}),Object(r.jsx)("p",{children:"The expression does not have a valid type"})]}),Object(r.jsx)("h2",{children:"Type derivation"}),c.value.steps.map((function(e,t){return Object(r.jsxs)("div",{className:"type-derivation-step",children:[Object(r.jsxs)("h3",{children:["Step ",t+1]}),Object(r.jsx)("p",{children:e.message.split("`").map((function(e,t){return t%2===0?e:Object(r.jsx)("code",{children:e},t)}))}),Object(r.jsx)(O,{ast:e.ast,hoverCallback:u})]},t)}))]})},S=document.getElementById("body")||{style:{overflow:""}};function F(e){var t=e.type,n=e.value,i=e.setter,a=e.current;return Object(r.jsx)("button",{className:a===n?"active":void 0,onClick:function(){i(n),f({name:t+"ButtonSet",value:n})},children:n})}var A=function(){var e=Object(i.useState)("map not []"),t=Object(d.a)(e,2),n=t[0],a=t[1],o=Object(i.useState)("w"),s=Object(d.a)(o,2),c=s[0],u=s[1],p=Object(i.useState)([]),l=Object(d.a)(p,2),y=l[0],g=l[1],b=Object(i.useState)(!1),m=Object(d.a)(b,2),v=m[0],j=m[1],O=function(){j(!1),f({name:"help",value:"hide"})};S.style.overflow=v?"hidden":"";var x=Object(i.useMemo)((function(){return n&&Object(r.jsx)(T,{code:n,algorithm:c,setHighlights:g})}),[n,c]);return Object(r.jsxs)("div",{id:"main",children:[v&&Object(r.jsx)("div",{className:"modal",onClick:function(e){"modal"===e.target.className&&O()},children:Object(r.jsxs)("div",{className:"modal-content",children:[Object(r.jsx)("button",{className:"sans-serif",onClick:function(){return O()},children:"Close"}),Object(r.jsx)("h2",{children:"Language reference"}),Object(r.jsxs)("p",{children:["The language is similar in syntax to Haskell. All functions are applied in prefix notation, i.e. ",Object(r.jsx)("code",{children:"+ 3 4"})," instead of ",Object(r.jsx)("code",{children:"3 + 4"}),". Anonymous functions only take one parameter, i.e. ",Object(r.jsxs)("code",{children:["\\x -",">"," \\y -",">"," y x"]})," instead of ",Object(r.jsxs)("code",{children:["\\x y -",">"," y x"]}),"."]}),Object(r.jsx)("p",{children:"The type constructors available are:"}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)("code",{children:"Int"})}),Object(r.jsx)("li",{children:Object(r.jsx)("code",{children:"Char"})}),Object(r.jsx)("li",{children:Object(r.jsx)("code",{children:"Bool"})}),Object(r.jsxs)("li",{children:[Object(r.jsxs)("code",{children:["-",">"]})," for functions"]}),Object(r.jsxs)("li",{children:[Object(r.jsx)("code",{children:"[]"})," for lists"]}),Object(r.jsxs)("li",{children:[Object(r.jsx)("code",{children:","}),", ",Object(r.jsx)("code",{children:",,"}),", ",Object(r.jsx)("code",{children:",,,"})," etc. for tuples"]}),Object(r.jsx)("li",{children:Object(r.jsx)("code",{children:"Maybe"})}),Object(r.jsx)("li",{children:Object(r.jsx)("code",{children:"Either"})})]}),Object(r.jsx)("p",{children:"The available set of built-in functions and their types are:"}),Object(r.jsx)("ul",{children:Object.entries(w.typeUtils.standardCtx).filter((function(e){return","!==Object(d.a)(e,1)[0][0]})).map((function(e){var t=Object(d.a)(e,2),n=t[0],i=t[1];return Object(r.jsx)("li",{children:Object(r.jsxs)("code",{children:[n," :: ",null===i||void 0===i?void 0:i.toString()]})},n)}))})]})}),Object(r.jsx)("h1",{children:"interactive type inference"}),Object(r.jsx)("h2",{children:"Play with algorithm W in your browser."}),Object(r.jsx)("p",{children:"Type inference is the ability to determine an expression's type in a language. Hindley-Milner (HM) is a typed \u03bb-calculus which allows for complete type inference without explicit type annotations. Haskell's type system is based on HM."}),Object(r.jsxs)("p",{children:["This tool allows you to enter expressions in syntax similar to Haskell and view how a type inference algorithm (algorithm W) could work out the types. A full list of built-in functions and their types is available ",Object(r.jsx)("button",{className:"sans-serif",onClick:function(){return j(!0),void f({name:"help",value:"show"})},"data-testid":"help-open-button",children:"here"}),". Expressions must be given in prefix notation, i.e. ",Object(r.jsx)(F,{type:"button",value:"+ 3 4",current:n,setter:a})," instead of ",Object(r.jsx)(F,{type:"code",value:"3 + 4",current:n,setter:a}),"."]}),Object(r.jsx)("p",{children:"Usage data such as button clicks and evaluated expressions may be collected to evaluate and improve the tool."}),Object(r.jsxs)("h2",{children:["Algorithm:",Object(r.jsx)(F,{type:"algorithm",value:"w",current:c,setter:u}),Object(r.jsx)(F,{type:"algorithm",value:"m",current:c,setter:u})]}),Object(r.jsxs)("h2",{children:["Samples:",Object(r.jsx)(F,{type:"code",value:"4",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"not",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"odd 5",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"map not []",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"fst",current:n,setter:a}),Object(r.jsx)("br",{className:"md-only"}),Object(r.jsx)(F,{type:"code",value:"Just",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"let x = 3 in (+, x)",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:"\\x -> / x 2",current:n,setter:a}),Object(r.jsx)(F,{type:"code",value:": 23 [1]",current:n,setter:a})]}),Object(r.jsxs)("div",{className:"code-container",children:[Object(r.jsx)("input",{placeholder:"Enter code...",value:n,onChange:function(e){a(e.target.value),h({name:"codeChange",value:e.target.value})}}),n&&y.map((function(e,t){return Object(r.jsxs)("p",{children:[n.slice(0,e.start),Object(r.jsx)("span",{className:e.className,children:n.slice(e.start,e.end)}),n.slice(e.end)]},t)}))]}),x]})};f({name:"load"}),s.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(A,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.cbae7dca.chunk.js.map