{"version":3,"sources":["../../algorithm-w/dist/index.js","../../language/dist/index.js","ASTView.tsx","ResultView.tsx","Main.tsx","index.tsx"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArrays","il","r","k","a","j","jl","defineProperty","exports","value","infer","unify","combine","substitute","TypeInferenceError","language_1","require","_super","message","_this","name","Error","substitution","arg","context","mappedContext","key","substitutions","_i","slice","newSubstitution","type1","type2","_a","TypeVar","contains","JSON","stringify","TypeFuncApp","constructorName","args","sub","diff","bset","Set","filter","v","has","freeVars","type","PolyType","monoType","quantifiedVars","map","reduce","acc","cur","values","_infer","expr","ctx","freshTypeName","_b","CharLiteral","inst","NumberLiteral","Var","App","_c","func","funcType","funcSubstitution","_d","argType","argSubstitution","unifiedSubstitution","Abs","_e","body","param","bodyType","bodySubstitution","Let","_f","def","defType","defSubstitution","_g","generalise","from","to","indexOf","bind","other","some","includes","forResponse","typeUtils","standardCtx","typeCounter","accepted","e","issuePosition","start","end","ParseError","parse","masala_parser_1","pos","toString","fun","join","number","char","boolean","f","one","two","extra","list","tuple","monoTypes","repeat","maybe","either","left","right","c","pt","mt","genlex","GenLex","identifier","tokenize","C","charIn","rep","charLiteral","stringLiteral","numberLiteral","N","backslash","arrow","string","lparen","rparen","letTok","equal","inTok","expression2","F","try","optApp","LEAF","or","ABS","LET","PAR","expression3","toCharArray","chars","split","getPos","charPos","offset","getOffset","input","location","guessedEnd","rawString","source","trimEnd","expandPos","lastIndexOf","drop","then","ABS_","single","lazy","at","LET_","parser","expressionPrime","array","nestLeft","optrep","prev","use","eos","code","response","Streams","ofString","isAccepted","NodeView","node","NodeWrapperView","className","NodeChildView","symbol","children","data-symbol","ASTView","ast","ResultView","setHighlights","parseResult","useMemo","useEffect","inferenceResult","Main","useState","setCode","highlights","onClick","placeholder","onChange","target","h","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"2FACA,IAAIA,EAAaC,MAAQA,KAAKD,WAAe,WACzC,IAAIE,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOC,OAAOK,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,MAC3EN,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASS,IAAOZ,KAAKa,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEO,UAAkB,OAANN,EAAaC,OAAOU,OAAOX,IAAMS,EAAGH,UAAYN,EAAEM,UAAW,IAAIG,IAV1C,GAazCG,EAAYf,MAAQA,KAAKe,UAAa,WAStC,OARAA,EAAWX,OAAOY,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAIX,KADTU,EAAIG,UAAUF,GACOf,OAAOK,UAAUC,eAAeC,KAAKO,EAAGV,KACzDS,EAAET,GAAKU,EAAEV,IAEjB,OAAOS,IAEKM,MAAMvB,KAAMqB,YAE5BG,EAAkBxB,MAAQA,KAAKwB,gBAAmB,WAClD,IAAK,IAAIN,EAAI,EAAGC,EAAI,EAAGM,EAAKJ,UAAUC,OAAQH,EAAIM,EAAIN,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAII,EAAInB,MAAMW,GAAIS,EAAI,EAA3B,IAA8BR,EAAI,EAAGA,EAAIM,EAAIN,IACzC,IAAK,IAAIS,EAAIP,UAAUF,GAAIU,EAAI,EAAGC,EAAKF,EAAEN,OAAQO,EAAIC,EAAID,IAAKF,IAC1DD,EAAEC,GAAKC,EAAEC,GACjB,OAAOH,GAEXtB,OAAO2B,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,EAAQT,MAAQS,EAAQE,MAAQF,EAAQG,MAAQH,EAAQI,QAAUJ,EAAQK,WAAaL,EAAQM,wBAAqB,EACpH,IAAIC,EAAaC,EAAQ,GACrBF,EAAoC,SAAUG,GAE9C,SAASH,EAAmBI,GACxB,IAAIC,EAAQF,EAAO9B,KAAKX,KAAM0C,IAAY1C,KAE1C,OADA2C,EAAMC,KAAO,qBACND,EAEX,OANA5C,EAAUuC,EAAoBG,GAMvBH,EAP6B,CAQtCO,OAEF,SAASR,EAAWS,EAAcC,GAC9B,IAAIC,EAAUD,EACVE,EAAgB,GACpB,IAAK,IAAIC,KAAOF,EACZC,EAAcC,GAAO3B,EAAMyB,EAAQE,GAAMJ,GAE7C,OAAOG,EAIX,SAASb,IAEL,IADA,IAAIe,EAAgB,GACXC,EAAK,EAAGA,EAAK/B,UAAUC,OAAQ8B,IACpCD,EAAcC,GAAM/B,UAAU+B,GAElC,GAA6B,IAAzBD,EAAc7B,OACd,MAAO,GACX,GAA6B,IAAzB6B,EAAc7B,OACd,OAAO6B,EAAc,GACzB,GAAIA,EAAc7B,OAAS,EACvB,OAAOc,EAAQe,EAAc,GAAIf,EAAQb,WAAM,EAAQ4B,EAAcE,MAAM,KAC/E,IAAIzB,EAAIuB,EAAc,GAClBhD,EAAIgD,EAAc,GAClBG,EAAkB,GACtB,IAAK,IAAIJ,KAAOtB,EACZ0B,EAAgBJ,GAAO3B,EAAMK,EAAEsB,GAAM/C,GAEzC,IAAK,IAAI+C,KAAO/C,EACN+C,KAAOtB,IACT0B,EAAgBJ,GAAO/C,EAAE+C,IAGjC,OAAOI,EAGX,SAASnB,EAAMoB,EAAOC,GAClB,IAAIC,EACJ,GAAIF,aAAiBhB,EAAWmB,QAAS,CACrC,GAAIC,EAASH,EAAOD,GAChB,MAAM,IAAIjB,EAAmB,qCAAuCsB,KAAKC,UAAUN,GAAS,QAAUK,KAAKC,UAAUL,IAEzH,OAAOC,EAAK,IAAOF,EAAMX,MAAQY,EAAOC,EAE5C,GAAID,aAAiBjB,EAAWmB,QAC5B,OAAOvB,EAAMqB,EAAOD,GAExB,GAAIA,aAAiBhB,EAAWuB,aAAeN,aAAiBjB,EAAWuB,YAAa,CACpF,GAAIP,EAAMQ,kBAAoBP,EAAMO,gBAChC,MAAM,IAAIzB,EAAmB,2EAA8EiB,EAAMQ,gBAAkB,UAAcP,EAAMO,gBAAkB,KAE7K,GAAIR,EAAMS,KAAK1C,SAAWkC,EAAMQ,KAAK1C,OACjC,MAAM,IAAIgB,EAAmB,mFAAqFsB,KAAKC,UAAUN,GAAS,QAAUK,KAAKC,UAAUL,IAGvK,IADA,IAAIS,EAAM,GACD9C,EAAI,EAAGA,EAAIoC,EAAMS,KAAK1C,OAAQH,IACnC8C,EAAM7B,EAAQD,EAAMZ,EAAMgC,EAAMS,KAAK7C,GAAI8C,GAAM1C,EAAMiC,EAAMQ,KAAK7C,GAAI8C,IAAOA,GAE/E,OAAOA,EAGX,MAAM,IAAIpB,MAAM,4CAIpB,SAASqB,EAAKtC,EAAGzB,GACb,IAAIgE,EAAO,IAAIC,IAAIjE,GACnB,OAAOyB,EAAEyC,QAAO,SAAUC,GAAK,OAAQH,EAAKI,IAAID,MAEpD,SAASE,EAASC,GACd,GAAIA,aAAgBlC,EAAWmC,SAC3B,OAAOR,EAAKM,EAASC,EAAKE,UAAWF,EAAKG,gBAE9C,GAAIH,aAAgBlC,EAAWmB,QAC3B,MAAO,CAACe,EAAK7B,MAEjB,GAAI6B,aAAgBlC,EAAWuB,YAC3B,OAAOW,EAAKT,KAAKa,IAAIL,GAAUM,QAAO,SAAUC,EAAKC,GAAO,OAAOxD,EAAeuD,EAAKC,KAAS,IAEpG,GAAIP,EAEA,OAAOrE,OAAO6E,OAAOR,GAAMI,IAAIL,GAAUM,QAAO,SAAUC,EAAKC,GAAO,OAAOxD,EAAeuD,EAAKC,KAAS,IAG9G,MAAM,IAAInC,MAAM,4CA2BpB,SAASqC,EAAOC,EAAMC,EAAKC,GACvB,IAAI5B,EAAI6B,EACR,GAAIH,aAAgB5C,EAAWgD,YAC3B,MAAO,CAACC,EAAK,IAAIjD,EAAWmC,SAAS,GAAI,IAAInC,EAAWuB,YAAY,SAAUuB,GAAgB,IAElG,GAAIF,aAAgB5C,EAAWkD,cAC3B,MAAO,CAACD,EAAK,IAAIjD,EAAWmC,SAAS,GAAI,IAAInC,EAAWuB,YAAY,WAAYuB,GAAgB,IAEpG,GAAIF,aAAgB5C,EAAWmD,IAAK,CAChC,IAAIjB,EAAOW,EAAID,EAAKvC,MACpB,IAAK6B,EACD,MAAM,IAAInC,EAAmB6C,EAAKvC,KAAO,oBAE7C,MAAO,CAAC4C,EAAKf,EAAMY,GAAgB,IAEvC,GAAIF,aAAgB5C,EAAWoD,IAAK,CAChC,IAAIC,EAAKV,EAAOC,EAAKU,KAAMT,EAAKC,GAAgBS,EAAWF,EAAG,GAAIG,EAAmBH,EAAG,GACpFI,EAAKd,EAAOC,EAAKpC,IAAKV,EAAW0D,EAAkBX,GAAMC,GAAgBY,EAAUD,EAAG,GAAIE,EAAkBF,EAAG,GAC/G/E,EAAI,IAAIsB,EAAWmB,QAAQ2B,KAC3Bc,EAAsBhE,EAAMZ,EAAMuE,EAAUI,GAAkB,IAAI3D,EAAWuB,YAAY,KAAMmC,EAAShF,IAC5G,MAAO,CAACM,EAAMN,EAAGkF,GAAsB/D,EAAQ2D,EAAkBG,EAAiBC,IAEtF,GAAIhB,aAAgB5C,EAAW6D,IAAK,CAC5BnF,EAAI,IAAIsB,EAAWmB,QAAQ2B,KAA/B,IACIgB,EAAKnB,EAAOC,EAAKmB,KAAMvF,EAASA,EAAS,GAAIqE,KAAO3B,EAAK,IAAO0B,EAAKoB,OAAS,IAAIhE,EAAWmC,SAAS,GAAIzD,GAAIwC,IAAM4B,GAAgBmB,EAAWH,EAAG,GAAII,EAAmBJ,EAAG,GAChL,MAAO,CAAC9E,EAAM,IAAIgB,EAAWuB,YAAY,KAAM7C,EAAGuF,GAAWC,GAAmBA,GAEpF,GAAItB,aAAgB5C,EAAWmE,IAAK,CAChC,IAAIC,EAAKzB,EAAOC,EAAKyB,IAAKxB,EAAKC,GAAgBwB,EAAUF,EAAG,GAAIG,EAAkBH,EAAG,GACjFI,EAAK7B,EAAOC,EAAKmB,KAAMvF,EAASA,EAAS,GAAIsB,EAAWyE,EAAiB1B,MAAQE,EAAK,IAAOH,EAAKoB,OAtD9G,SAAoBnB,EAAKX,GACrB,OAAO,IAAIlC,EAAWmC,SAASR,EAAKM,EAASC,GAAOD,EAASY,IAAOX,GAqD+CuC,CAAW3E,EAAWyE,EAAiB1B,GAAMyB,GAAUvB,IAAMD,GAC5K,MAAO,CADqLmB,EAAWO,EAAG,GACxL3E,EAAQ0E,EADoLL,EAAmBM,EAAG,KAIxO,MAAM,IAAIlE,MAAM,4CAEpB,SAAS2C,EAAKf,EAAMY,EAAe4B,EAAMC,GAGrC,QAFa,IAATD,IAAmBA,EAAO,SACnB,IAAPC,IAAiBA,EAAK,IACtBzC,aAAgBlC,EAAWmB,QAAS,CACpC,IAAIvC,EAAI8F,EAAKE,QAAQ1C,EAAK7B,MAC1B,OAAe,IAAPzB,EAAYsD,EAAO,IAAIlC,EAAWmB,QAAQwD,EAAG/F,IAEzD,GAAIsD,aAAgBlC,EAAWuB,YAC3B,OAAO,IAAKvB,EAAWuB,YAAYsD,KAAK7F,MAAMgB,EAAWuB,YAAatC,EAAe,MAAC,EAAQiD,EAAKV,iBAAkBU,EAAKT,KAAKa,KAAI,SAAU9B,GAAO,OAAOyC,EAAKzC,EAAKsC,EAAe4B,EAAMC,SAE9L,GAAIzC,aAAgBlC,EAAWmC,SAC3B,OAAOc,EAAKf,EAAKE,SAAUU,EAAeZ,EAAKG,eAAgBH,EAAKG,eAAeC,IAAIQ,IAG3F,MAAM,IAAIxC,MAAM,4CAEpB,SAAStB,EAAMkD,EAAM3B,GACjB,GAAI2B,aAAgBlC,EAAWmB,QAC3B,OAAOe,EAAK7B,QAAQE,EAAeA,EAAa2B,EAAK7B,MAAQ6B,EAEjE,GAAIA,aAAgBlC,EAAWuB,YAC3B,OAAO,IAAKvB,EAAWuB,YAAYsD,KAAK7F,MAAMgB,EAAWuB,YAAatC,EAAe,MAAC,EAAQiD,EAAKV,iBAAkBU,EAAKT,KAAKa,KAAI,SAAU9B,GAAO,OAAOxB,EAAMwB,EAAKD,SAE1K,GAAI2B,aAAgBlC,EAAWmC,SAC3B,OAAO,IAAInC,EAAWmC,SAASD,EAAKG,eAAgBrD,EAAMkD,EAAKE,SAAU7B,IAG7E,MAAM,IAAID,MAAM,4CAGpB,SAASc,EAASc,EAAM4C,GACpB,GAAI5C,aAAgBlC,EAAWmB,QAC3B,OAAOe,EAAK7B,MAAQyE,EAAMzE,KAE9B,GAAI6B,aAAgBlC,EAAWuB,YAC3B,OAAOW,EAAKT,KAAKsD,MAAK,SAAUvE,GAAO,OAAOY,EAASZ,EAAKsE,MAEhE,GAAI5C,aAAgBlC,EAAWmC,SAC3B,OAAOf,EAASc,EAAKE,SAAU0C,KAAW5C,EAAKG,eAAe2C,SAASF,EAAMzE,MAGjF,MAAM,IAAIC,MAAM,4CA3LpBb,EAAQM,mBAAqBA,EAS7BN,EAAQK,WAAaA,EA0BrBL,EAAQI,QAAUA,EA4BlBJ,EAAQG,MAAQA,EA+ChBH,EAAQE,MArBR,SAAeiD,EAAMqC,EAAapC,QACV,IAAhBoC,IAA0BA,GAAc,QAChC,IAARpC,IAAkBA,EAAM7C,EAAWkF,UAAUC,aACjD,IAAIC,EAAc,EACdtC,EAAgB,WAAc,MAAO,IAAMsC,KAC/C,IAAKH,EACD,OAAOtC,EAAOC,EAAMC,EAAKC,GAAe,GAC5C,IACI,MAAO,CACHuC,UAAU,EACV3F,MAAOiD,EAAOC,EAAMC,EAAKC,GAAe,IAGhD,MAAOwC,GACH,MAAO,CACHD,UAAU,EACVE,cAAe,CAAEC,MAAO,EAAGC,IAAK,GAChCtF,QAASmF,EAAEnF,WAqEvBV,EAAQT,MAAQA,G,+BC1NhB,IAAIxB,EAAaC,MAAQA,KAAKD,WAAe,WACzC,IAAIE,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOC,OAAOK,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,MAC3EN,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASS,IAAOZ,KAAKa,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEO,UAAkB,OAANN,EAAaC,OAAOU,OAAOX,IAAMS,EAAGH,UAAYN,EAAEM,UAAW,IAAIG,IAV1C,GAazCY,EAAkBxB,MAAQA,KAAKwB,gBAAmB,WAClD,IAAK,IAAIN,EAAI,EAAGC,EAAI,EAAGM,EAAKJ,UAAUC,OAAQH,EAAIM,EAAIN,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAII,EAAInB,MAAMW,GAAIS,EAAI,EAA3B,IAA8BR,EAAI,EAAGA,EAAIM,EAAIN,IACzC,IAAK,IAAIS,EAAIP,UAAUF,GAAIU,EAAI,EAAGC,EAAKF,EAAEN,OAAQO,EAAIC,EAAID,IAAKF,IAC1DD,EAAEC,GAAKC,EAAEC,GACjB,OAAOH,GAEXtB,OAAO2B,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,EAAQyF,UAAYzF,EAAQiG,WAAajG,EAAQkG,MAAQlG,EAAQ0C,SAAW1C,EAAQ8B,YAAc9B,EAAQ0B,QAAU1B,EAAQ0E,IAAM1E,EAAQoE,IAAMpE,EAAQ2D,IAAM3D,EAAQ0D,IAAM1D,EAAQyD,cAAgBzD,EAAQuD,iBAAc,EAC1N,IAAI4C,EAAkB3F,EAAQ,IAC1B+C,EAA6B,WAC7B,SAASA,EAAYtD,EAAOmG,GACxBpI,KAAKiC,MAAQA,EACbjC,KAAKoI,IAAMA,EAKf,OAHA7C,EAAY9E,UAAU4H,SAAW,WAC7B,OAAOrI,KAAKiC,OAETsD,EARsB,GAUjCvD,EAAQuD,YAAcA,EACtB,IAAIE,EAA+B,WAC/B,SAASA,EAAcxD,EAAOmG,GAC1BpI,KAAKiC,MAAQA,EACbjC,KAAKoI,IAAMA,EAKf,OAHA3C,EAAchF,UAAU4H,SAAW,WAC/B,OAAOrI,KAAKiC,MAAMoG,YAEf5C,EARwB,GAUnCzD,EAAQyD,cAAgBA,EACxB,IAAIC,EAAqB,WACrB,SAASA,EAAI9C,EAAMwF,GACfpI,KAAK4C,KAAOA,EACZ5C,KAAKoI,IAAMA,EAKf,OAHA1C,EAAIjF,UAAU4H,SAAW,WACrB,OAAOrI,KAAK4C,MAET8C,EARc,GAUzB1D,EAAQ0D,IAAMA,EACd,IAAIC,EAAqB,WACrB,SAASA,EAAI2C,EAAKvF,EAAKqF,GACnBpI,KAAK6F,KAAOyC,EACZtI,KAAK+C,IAAMA,EACX/C,KAAKoI,IAAMA,EAKf,OAHAzC,EAAIlF,UAAU4H,SAAW,WACrB,MAAO,IAAMrI,KAAK6F,KAAKwC,WAAa,IAAMrI,KAAK+C,IAAIsF,WAAa,KAE7D1C,EATc,GAWzB3D,EAAQ2D,IAAMA,EACd,IAAIS,EAAqB,WACrB,SAASA,EAAIG,EAAOD,EAAM8B,GACtBpI,KAAKuG,MAAQA,EACbvG,KAAKsG,KAAOA,EACZtG,KAAKoI,IAAMA,EAKf,OAHAhC,EAAI3F,UAAU4H,SAAW,WACrB,MAAO,MAAQrI,KAAKuG,MAAQ,OAASvG,KAAKsG,KAAK+B,WAAa,KAEzDjC,EATc,GAWzBpE,EAAQoE,IAAMA,EACd,IAAIM,EAAqB,WACrB,SAASA,EAAIH,EAAOK,EAAKN,EAAM8B,GAC3BpI,KAAKuG,MAAQA,EACbvG,KAAK4G,IAAMA,EACX5G,KAAKsG,KAAOA,EACZtG,KAAKoI,IAAMA,EAKf,OAHA1B,EAAIjG,UAAU4H,SAAW,WACrB,MAAO,QAAUrI,KAAKuG,MAAQ,MAAQvG,KAAK4G,IAAIyB,WAAa,OAASrI,KAAKsG,KAAK+B,WAAa,KAEzF3B,EAVc,GAYzB1E,EAAQ0E,IAAMA,EACd,IAAIhD,EAAyB,WACzB,SAASA,EAAQd,GACb5C,KAAK4C,KAAOA,EAKhB,OAHAc,EAAQjD,UAAU4H,SAAW,WACzB,OAAOrI,KAAK4C,MAETc,EAPkB,GAS7B1B,EAAQ0B,QAAUA,EAClB,IAAII,EAA6B,WAC7B,SAASA,EAAYC,GAEjB,IADA,IAAIC,EAAO,GACFZ,EAAK,EAAGA,EAAK/B,UAAUC,OAAQ8B,IACpCY,EAAKZ,EAAK,GAAK/B,UAAU+B,GAE7BpD,KAAK+D,gBAAkBA,EACvB/D,KAAKgE,KAAOA,EAKhB,OAHAF,EAAYrD,UAAU4H,SAAW,WAC7B,OAAOrI,KAAK+D,iBAAmB/D,KAAKgE,KAAK1C,OAAS,IAAM,IAAMtB,KAAKgE,KAAKa,KAAI,SAAUjD,GAAK,MAAO,IAAMA,EAAEyG,WAAa,OAAQE,KAAK,MAEjIzE,EAZsB,GAcjC9B,EAAQ8B,YAAcA,EACtB,IAAIY,EAA0B,WAC1B,SAASA,EAASE,EAAgBD,GAC9B3E,KAAK4E,eAAiBA,EACtB5E,KAAK2E,SAAWA,EAKpB,OAHAD,EAASjE,UAAU4H,SAAW,WAC1B,OAAOrI,KAAK4E,eAAeC,KAAI,SAAUP,GAAK,MAAO,SAAMA,KAAMiE,KAAK,IAAM,KAAOvI,KAAK2E,SAAS0D,YAE9F3D,EARmB,GAU9B1C,EAAQ0C,SAAWA,EAGnB,IAAI8D,EAAS,IAAI1E,EAAY,UACzB2E,EAAO,IAAI3E,EAAY,QACvB4E,EAAU,IAAI5E,EAAY,WAC1B6E,EAAI,SAAJA,EAAcC,EAAKC,GAEnB,IADA,IAAIC,EAAQ,GACH1F,EAAK,EAAGA,EAAK/B,UAAUC,OAAQ8B,IACpC0F,EAAM1F,EAAK,GAAK/B,UAAU+B,GAE9B,OAAqB,IAAjB0F,EAAMxH,OACC,IAAIwC,EAAY,KAAM8E,EAAKC,GAC/B,IAAI/E,EAAY,KAAM8E,EAAKD,EAAEpH,WAAM,EAAQC,EAAe,CAACqH,EAAKC,EAAM,IAAKA,EAAMzF,MAAM,OAE9F0F,EAAO,SAAUpE,GAAY,OAAO,IAAIb,EAAY,KAAMa,IAC1DqE,EAAQ,WAER,IADA,IAAIC,EAAY,GACP7F,EAAK,EAAGA,EAAK/B,UAAUC,OAAQ8B,IACpC6F,EAAU7F,GAAM/B,UAAU+B,GAE9B,GAAI6F,EAAU3H,QAAU,EACpB,MAAM,IAAIuB,MAAM,sDAAwDoG,EAAU3H,QACtF,GAAI2H,EAAU3H,OAAS,EACnB,MAAM,IAAIuB,MAAM,uDAAyDoG,EAAU3H,QACvF,OAAO,IAAKwC,EAAYsD,KAAK7F,MAAMuC,EAAatC,EAAe,MAAC,EAAQ,IAAI0H,OAAOD,EAAU3H,OAAS,IAAK2H,MAE3GE,EAAQ,SAAUxE,GAAY,OAAO,IAAIb,EAAY,QAASa,IAC9DyE,EAAS,SAAUC,EAAMC,GAAS,OAAO,IAAIxF,EAAY,SAAUuF,EAAMC,IACzE1H,EAAI,IAAI8B,EAAQ,KAChBvD,EAAI,IAAIuD,EAAQ,KAChB6F,EAAI,IAAI7F,EAAQ,KAChBxD,EAAI,IAAIwD,EAAQ,KAChB8F,EAAK,SAAUC,GAAM,OAAO,IAAI/E,EAAS,GAAI+E,IAE7C/B,EAAc,CAEd,IAAK8B,EAAGb,EAAEH,EAAQA,EAAQA,IAC1B,IAAKgB,EAAGb,EAAEH,EAAQA,EAAQA,IAC1B,IAAKgB,EAAGb,EAAEH,EAAQA,EAAQA,IAC1B,IAAKgB,EAAGb,EAAEH,EAAQA,EAAQA,IAC1B,IAAKgB,EAAGb,EAAEH,EAAQA,EAAQA,IAC1B,OAAUgB,EAAGb,EAAEH,EAAQA,IACvB,IAAOgB,EAAGb,EAAEH,EAAQA,IACpB,OAAUgB,EAAGb,EAAEH,EAAQA,IACvB,KAAQgB,EAAGb,EAAEH,EAAQE,IACrB,IAAOc,EAAGb,EAAEH,EAAQE,IAEpB,IAAOc,EAAGb,EAAED,EAASA,IACrB,KAAMc,EAAGb,EAAED,EAASA,EAASA,IAC7B,KAAMc,EAAGb,EAAED,EAASA,EAASA,IAC7B,KAAQc,EAAGd,GACX,MAASc,EAAGd,GAEZ,SAAYc,EAAGhB,GACf,UAAagB,EAAGd,GAEhB,KAAM,IAAIhE,EAAS,CAAC,KAAMqE,EAAKnH,IAC/B,IAAK,IAAI8C,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAImH,EAAKnH,KAC5C,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAImH,EAAKnH,KAC/C,KAAM,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,GAAImH,EAAKnH,KACnD,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAIA,IACvC,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAIA,IACvC,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,KAC5C,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,KAC5C,OAAU,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAIuH,EAAMH,EAAMpH,EAAGmH,EAAKnH,OAC7D,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAI8G,IACvC,OAAU,IAAIhE,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAI4G,IACzC,IAAO,IAAI9D,EAAS,CAAC,IAAK,KAAMiE,EAAEA,EAAE/G,EAAGzB,GAAI4I,EAAKnH,GAAImH,EAAK5I,KACzD,QAAW,IAAIuE,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,KAC/C,YAAe,IAAI8C,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAImH,EAAKnH,KACtD,YAAe,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKA,EAAKnH,IAAKmH,EAAKnH,KAClE,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKA,EAAKnH,IAAKmH,EAAKA,EAAMnH,MAC7D,aAAgB,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKA,EAAMnH,MAC1D,aAAgB,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKA,EAAMnH,MAC1D,MAAS,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAExI,EAAGyB,EAAGzB,GAAIA,EAAG4I,EAAKnH,GAAIzB,IACvD,SAAW,IAAIuE,EAAS,CAAC,KAAMiE,EAAEA,EAAExI,EAAGyB,EAAGzB,GAAIA,EAAG4I,EAAKnH,GAAIzB,IACzD,OAAU,IAAIuE,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAGA,EAAGA,GAAImH,EAAKnH,GAAIA,IACrD,UAAY,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAGA,EAAGA,GAAImH,EAAKnH,GAAIA,IACvD,MAAS,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAGzB,EAAGA,GAAIA,EAAG4I,EAAKnH,GAAIzB,IACvD,OAAU,IAAIuE,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAGA,EAAGA,GAAImH,EAAKnH,GAAIA,IACrD,OAAU,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKA,EAAKnH,IAAKmH,EAAKnH,KACpD,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAGmH,EAAKnH,IAAKmH,EAAKnH,GAAImH,EAAK5I,KAChE,IAAOqJ,EAAGb,EAAEI,EAAKL,GAAUA,IAC3B,GAAMc,EAAGb,EAAEI,EAAKL,GAAUA,IAC1B,IAAO,IAAIhE,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAI8G,IACrD,IAAO,IAAIhE,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAI8G,IACrD,IAAOc,EAAGb,EAAEI,EAAKP,GAASA,IAC1B,QAAWgB,EAAGb,EAAEI,EAAKP,GAASA,IAC9B,QAAWgB,EAAGb,EAAEI,EAAKP,GAASA,IAC9B,QAAWgB,EAAGb,EAAEI,EAAKP,GAASA,IAC9B,KAAQ,IAAI9D,EAAS,CAAC,KAAMiE,EAAEH,EAAQO,EAAKnH,GAAImH,EAAKnH,KACpD,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEH,EAAQO,EAAKnH,GAAImH,EAAKnH,KACpD,QAAW,IAAI8C,EAAS,CAAC,KAAMiE,EAAEH,EAAQO,EAAKnH,GAAIoH,EAAMD,EAAKnH,GAAImH,EAAKnH,MACtE,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAImH,EAAKnH,KAChE,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAImH,EAAKnH,KAChE,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAI8G,IAC1C,QAAW,IAAIhE,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAI8G,IAC7C,OAAU,IAAIhE,EAAS,CAAC,IAAK,KAAMiE,EAAE/G,EAAGmH,EAAKC,EAAMpH,EAAGzB,IAAKgJ,EAAMhJ,KACjE,KAAQ,IAAIuE,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAIuH,EAAMvH,KAC5D,OAAU,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAImH,EAAKnH,KAC7D,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEA,EAAE/G,EAAG8G,GAAUK,EAAKnH,GAAIoH,EAAMD,EAAKnH,GAAImH,EAAKnH,MAC/E,KAAM,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAI4G,EAAQ5G,IAC7C,IAAO,IAAI8C,EAAS,CAAC,IAAK,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAK5I,GAAI4I,EAAKC,EAAMpH,EAAGzB,MAClE,QAAW,IAAIuE,EAAS,CAAC,IAAK,IAAK,KAAMiE,EAAEA,EAAE/G,EAAGzB,EAAGoJ,GAAIR,EAAKnH,GAAImH,EAAK5I,GAAI4I,EAAKQ,KAC9E,MAAS,IAAI7E,EAAS,CAAC,IAAK,KAAMiE,EAAEI,EAAKC,EAAMpH,EAAGzB,IAAK6I,EAAMD,EAAKnH,GAAImH,EAAK5I,MAC3E,IAAO,IAAIuE,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,KAC3C,OAAU,IAAI8C,EAAS,CAAC,KAAMiE,EAAE/G,EAAGmH,EAAKnH,GAAImH,EAAKnH,KACjD,OAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,GAAImH,EAAKnH,KACrD,MAAS,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,GAAImH,EAAKnH,KACtD,UAAa,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,GAAImH,EAAKnH,KAC1D,KAAQ,IAAI8C,EAAS,CAAC,KAAMiE,EAAEI,EAAKnH,GAAImH,EAAKnH,KAE5C,IAAK,IAAI8C,EAAS,CAAC,IAAK,KAAMiE,EAAE/G,EAAGzB,EAAG6I,EAAMpH,EAAGzB,KAC/C,KAAM,IAAIuE,EAAS,CAAC,IAAK,IAAK,KAAMiE,EAAE/G,EAAGzB,EAAGoJ,EAAGP,EAAMpH,EAAGzB,EAAGoJ,KAC3D,MAAO,IAAI7E,EAAS,CAAC,IAAK,IAAK,IAAK,KAAMiE,EAAE/G,EAAGzB,EAAGoJ,EAAGrJ,EAAG8I,EAAMpH,EAAGzB,EAAGoJ,EAAGrJ,KACvE,IAAO,IAAIwE,EAAS,CAAC,IAAK,KAAMiE,EAAEK,EAAMpH,EAAGzB,GAAIyB,IAC/C,IAAO,IAAI8C,EAAS,CAAC,IAAK,KAAMiE,EAAEK,EAAMpH,EAAGzB,GAAIA,IAC/C,MAAS,IAAIuE,EAAS,CAAC,IAAK,IAAK,KAAMiE,EAAEA,EAAEK,EAAMpH,EAAGzB,GAAIoJ,GAAI3H,EAAGzB,EAAGoJ,IAClE,QAAW,IAAI7E,EAAS,CAAC,IAAK,IAAK,KAAMiE,EAAEA,EAAE/G,EAAGzB,EAAGoJ,GAAIP,EAAMpH,EAAGzB,GAAIoJ,IAEpE,KAAQ,IAAI7E,EAAS,CAAC,KAAMiE,EAAE/G,EAAGuH,EAAMvH,KACvC,QAAW,IAAI8C,EAAS,CAAC,KAAMyE,EAAMvH,IAErC,KAAQ,IAAI8C,EAAS,CAAC,IAAK,KAAMiE,EAAE/G,EAAGwH,EAAOxH,EAAGzB,KAChD,MAAS,IAAIuE,EAAS,CAAC,IAAK,KAAMiE,EAAExI,EAAGiJ,EAAOxH,EAAGzB,KAEjD,GAAM,IAAIuE,EAAS,CAAC,KAAMiE,EAAE/G,EAAGA,KAa/BqG,EAA4B,SAAUxF,GAEtC,SAASwF,EAAWvF,GAChB,IAAIC,EAAQF,EAAO9B,KAAKX,KAAM0C,IAAY1C,KAE1C,OADA2C,EAAMC,KAAO,aACND,EAEX,OANA5C,EAAUkI,EAAYxF,GAMfwF,EAPqB,CAQ9BpF,OACFb,EAAQiG,WAAaA,EACrB,IAAIyB,EAAS,IAAIvB,EAAgBwB,OAC7BC,EAAaF,EAAOG,SAAS1B,EAAgB2B,EAAEC,OAAO,iFAAiFC,MAAMnF,KAAI,SAAU5D,GAAK,OAAOA,EAAEsH,UAAY,cACrL0B,EAAcP,EAAOG,SAAS1B,EAAgB2B,EAAEG,cAAe,QAC/DC,EAAgBR,EAAOG,SAAS1B,EAAgB2B,EAAEI,gBAAiB,UACnEC,EAAgBT,EAAOG,SAAS1B,EAAgBiC,EAAE5B,SAAU,UAC5D6B,EAAYX,EAAOG,SAAS1B,EAAgB2B,EAAErB,KAAK,MAAO,aAC1D6B,EAAQZ,EAAOG,SAAS1B,EAAgB2B,EAAES,OAAO,MAAO,SACxDC,EAASd,EAAOG,SAAS1B,EAAgB2B,EAAErB,KAAK,KAAM,UACtDgC,EAASf,EAAOG,SAAS1B,EAAgB2B,EAAErB,KAAK,KAAM,UACtDiC,EAAShB,EAAOG,SAAS1B,EAAgB2B,EAAES,OAAO,OAAQ,OAC1DI,EAAQjB,EAAOG,SAAS1B,EAAgB2B,EAAErB,KAAK,KAAM,SACrDmC,EAAQlB,EAAOG,SAAS1B,EAAgB2B,EAAES,OAAO,MAAO,MAMxDM,EAAc,WACd,OAAO1C,EAAgB2C,EAAEC,IAAIC,EAAOC,MAC/BC,GAAG/C,EAAgB2C,EAAEC,IAAIC,EAAOG,OAChCD,GAAG/C,EAAgB2C,EAAEC,IAAIC,EAAOI,OAChCF,GAAG/C,EAAgB2C,EAAEC,IAAIC,EAAOK,QAErCC,EAAc,WACd,OAAOnD,EAAgB2C,EAAEC,IAAIE,KACxBC,GAAG/C,EAAgB2C,EAAEC,IAAII,MACzBD,GAAG/C,EAAgB2C,EAAEC,IAAIK,MACzBF,GAAG/C,EAAgB2C,EAAEC,IAAIM,OAE9BE,EAAc,SAAUhB,EAAQ7I,GAIhC,IAHA,IAAI8J,EAAQjB,EAAOkB,MAAM,IACrBrD,EAAMsD,EAAOhK,GACbyD,EAAO,IAAIO,EAAI,KAAM,CAAEqC,MAAOK,EAAIJ,IAAM,EAAGA,IAAKI,EAAIJ,MAC/C7G,EAAIqK,EAAMlK,OAAS,EAAGH,GAAK,EAAGA,IAAK,CACxC,IAAIwK,EAAU,CAAE5D,MAAOK,EAAIL,MAAQ,EAAI5G,EAAG6G,IAAKI,EAAIL,MAAQ,EAAI5G,GAC/DgE,EAAO,IAAIQ,EAAI,IAAIA,EAAI,IAAID,EAAI,IAAKiG,GAAU,IAAIpG,EAAYiG,EAAMrK,GAAIwK,GAAUA,GAAUxG,EAAM,CAAE4C,MAAOK,EAAIL,MAAQ,EAAI5G,EAAG6G,IAAKI,EAAIJ,IAAM,IAIjJ,OAFA7C,EAAKiD,IAAIL,MAAQK,EAAIL,MACrB5C,EAAKiD,IAAIJ,IAAMI,EAAIJ,IACZ7C,GAEPuG,EAAS,SAAUhK,GACnB,IAAIkK,EAASlK,EAAEmK,YAAc,EACzB9D,EAAQrG,EAAEoK,MAAMC,SAASH,GACzBI,EAAatK,EAAEoK,MAAMC,SAASH,EAAS,GACvCK,EAAYvK,EAAEoK,MAAMI,OAAOJ,MAAMI,OAAO7I,MAAM0E,EAAOiE,GAEzD,MAAO,CAAEjE,MAAOA,EAAOC,IADbgE,GAAcC,EAAU3K,OAAS2K,EAAUE,UAAU7K,UAG/D8K,EAAY,SAAU9H,EAAG5C,GACzB,IAAIuK,EAAYvK,EAAEoK,MAAMI,OAAOJ,MAAMI,OAGrC,OAFA5H,EAAE8D,IAAIJ,KAAOiE,EAAU5I,MAAMiB,EAAE8D,IAAIJ,KAAKb,QAAQ,KAAO,EACvD7C,EAAE8D,IAAIL,MAAQkE,EAAU5I,MAAM,EAAGiB,EAAE8D,IAAIL,OAAOsE,YAAY,KACnD/H,GAGP2G,EAAO,WAAc,OAAO9C,EAAgB2C,EAAEC,IAAIZ,EAActF,KAAI,SAAU5C,EAAOP,GAAK,OAAO,IAAI+D,EAAcxD,EAAOyJ,EAAOhK,QAASwJ,GAAG/C,EAAgB2C,EAAEC,IAAIb,EAAcrF,IAAI0G,KAAeL,GAAG/C,EAAgB2C,EAAEC,IAAId,EAAYpF,KAAI,SAAU5C,EAAOP,GAAK,OAAO,IAAI6D,EAAYtD,EAAOyJ,EAAOhK,SAAUwJ,GAAG/C,EAAgB2C,EAAEC,IAAInB,EAAW/E,KAAI,SAAU5C,EAAOP,GAAK,OAAO,IAAIgE,EAAIzD,EAAOyJ,EAAOhK,UAC7YyJ,EAAM,WAAc,OAAOX,EAAO8B,OAAOC,KAAKC,KAAQD,KAAK9B,EAAO6B,QAAQG,SAAS5H,IAAIuH,IACvFI,EAAO,WAAc,OAAOnC,EAAUxF,KAAI,SAAUP,EAAG5C,GAAK,OAAOA,EAAEqK,WAAa,KAAMQ,KAAK3C,GAAY2C,KAAKjC,EAAMgC,QAAQC,KAAKpE,EAAgB2C,EAAE4B,KAAK7B,IAAchG,KAAI,SAAUmE,EAAOtH,GAAK,OAAO,IAAI0E,EAAI4C,EAAM2D,GAAG,GAAI3D,EAAM2D,GAAG,GAAI,CAAE5E,MAAOiB,EAAM2D,GAAG,GAAI3E,IAAKtG,EAAEqK,iBACtQV,EAAM,WAAc,OAAOb,EAAO8B,OAAOC,KAAKpE,EAAgB2C,EAAE4B,KAAK7B,IAAc0B,KAAK9B,EAAO6B,QAAQG,SAAS5H,IAAIuH,IACpHhB,EAAM,WAAc,OAAOZ,EAAO8B,OAAOC,KAAKK,KAAQL,KAAK9B,EAAO6B,QAAQG,SAAS5H,IAAIuH,IACvFQ,EAAO,WAAc,OAAOlC,EAAO7F,KAAI,SAAUP,EAAG5C,GAAK,OAAOgK,EAAOhK,GAAGqG,SAAUwE,KAAK3C,GAAY2C,KAAK5B,EAAM2B,QAAQC,KAAKpE,EAAgB2C,EAAE4B,KAAK7B,IAAc0B,KAAK3B,EAAM0B,QAAQC,KAAKpE,EAAgB2C,EAAE4B,KAAK7B,IAAchG,KAAI,SAAUmE,EAAOtH,GAAK,OAAO,IAAIgF,EAAIsC,EAAM2D,GAAG,GAAI3D,EAAM2D,GAAG,GAAI3D,EAAM2D,GAAG,GAAI,CAAE5E,MAAOiB,EAAM2D,GAAG,GAAI3E,IAAKtG,EAAEqK,iBAC5Uf,EAAS,SAAU6B,GAAU,OAAOA,EAAON,KAAKO,MAAmBC,QAAQlI,IAAImI,KAC/EF,GAAkB,WAAc,OAAO3E,EAAgB2C,EAAE4B,KAAKpB,GAAa2B,UAC3ED,GAAW,SAAU1I,GAAK,OAAOA,EAAEQ,QAAO,SAAUoI,EAAMlI,GAAO,OAAO,IAAIW,EAAIuH,EAAMlI,EAAK,CAAE+C,MAAOmF,EAAK9E,IAAIL,MAAOC,IAAKhD,EAAIoD,IAAIJ,UACjI6E,GAASnD,EAAOyD,IApDThF,EAAgB2C,EAAEC,IAAI6B,KACxB1B,GAAG/C,EAAgB2C,EAAEC,IAAIyB,MACzBtB,GAAG/C,EAAgB2C,EAAEC,IAAIF,MAkDI0B,KAAKpE,EAAgB2C,EAAEsC,MAAMd,QAAQG,UAa3EzK,EAAQkG,MAZR,SAAemF,EAAM7F,QACG,IAAhBA,IAA0BA,GAAc,GAC5C,IAAI8F,EAAWT,GAAO3E,MAAMC,EAAgBoF,QAAQC,SAASH,IAC7D,GAAI7F,EACA,OAAI8F,EAASG,aACF,CAAE7F,UAAU,EAAM3F,MAAOqL,EAASrL,OACtC,CAAE2F,UAAU,EAAOE,cAAe,CAAEC,MAAOuF,EAASvB,WAAY/D,IAAKqF,EAAK/L,QAAUoB,QAAS,mBAExG,GAAI4K,EAASG,aACT,OAAOH,EAASrL,MACpB,MAAM,IAAIgG,EAAW,uBAAyBoF,EAAO,OAAS,IAAInE,OAAOoE,EAASvB,YAAc,MAGpG,IAAItE,GAAY,CAAEe,OAAQA,EAAQC,KAAMA,EAAMC,QAASA,EAASC,EAAGA,EAAGI,KAAMA,EAAMC,MAAOA,EAAOG,MAAOA,EAAOC,OAAQA,EAAQxH,EAAGA,EAAGzB,EAAGA,EAAGoJ,EAAGA,EAAGrJ,EAAGA,EAAGsJ,GAAIA,EAAI9B,YAAaA,GAC3K1F,EAAQyF,UAAYA,I,uIChWpB,SAASiG,EAAT,GAA6C,IAAzBC,EAAwB,EAAxBA,KAChB,GAAIA,aAAgBpI,eAAeoI,aAAgBlI,gBAC/C,OAAO,cAACmI,EAAD,UAAkBD,EAAK1L,QAGlC,GAAI0L,aAAgBjI,MAChB,OAAO,cAACkI,EAAD,UAAkBD,EAAK/K,OAGlC,GAAI+K,aAAgBhI,MAChB,OAAO,qCACH,cAACiI,EAAD,UAAiB,sBAAMC,UAAU,aAAhB,oCACjB,cAACC,EAAD,UAAe,cAACJ,EAAD,CAAUC,KAAMA,EAAK9H,SACpC,cAACiI,EAAD,UAAe,cAACJ,EAAD,CAAUC,KAAMA,EAAK5K,WAI5C,GAAI4K,aAAgBvH,MAChB,OAAO,qCACH,eAACwH,EAAD,oBAAmBD,EAAKpH,SACxB,cAACuH,EAAD,CAAeC,OAAO,KAAtB,SAA2B,cAACL,EAAD,CAAUC,KAAMA,EAAKrH,YAIxD,GAAIqH,aAAgBjH,MAChB,OAAO,qCACH,eAACkH,EAAD,kBAAsBD,EAAKpH,SAC3B,cAACuH,EAAD,CAAeC,OAAO,IAAtB,SAA0B,cAACL,EAAD,CAAUC,KAAMA,EAAK/G,QAC/C,cAACkH,EAAD,CAAeC,OAAO,KAAtB,SAA2B,cAACL,EAAD,CAAUC,KAAMA,EAAKrH,YAIxD,MAAM,IAAIzD,MAAM,sDAAwD8K,GAG5E,SAASC,EAAT,GAAiE,IAAtCI,EAAqC,EAArCA,SACvB,OAAO,qBAAKH,UAAU,WAAf,SAA2BG,IAGtC,SAASF,EAAT,GAAwF,IAA/DE,EAA8D,EAA9DA,SAAUD,EAAoD,EAApDA,OAC/B,OAAO,qBAAKF,UAAU,YAAYI,cAAaF,EAAxC,SAAiDC,IAG7CE,MA/Cf,YAA0C,IAAvBC,EAAsB,EAAtBA,IACf,OAAO,qBAAKN,UAAU,WAAf,SAA0B,cAACH,EAAD,CAAUC,KAAMQ,OC+CtCC,MAxCf,YAAyG,IAAnFf,EAAkF,EAAlFA,KAAMgB,EAA4E,EAA5EA,cAEpBC,EAAcC,mBAAQ,WAC1B,OAAOrG,gBAAMmF,GAAM,KAClB,CAACA,IACJmB,qBAAU,kBAAMH,EAAcC,EAAY1G,SAAW,GAAK,CAAC,CAAEG,MAAOuG,EAAYxG,cAAcC,MAAOC,IAAKsG,EAAYxG,cAAcE,KAAO,EAAG6F,UAAW,aAAa,CAACS,EAAaD,IAGpL,IAAMI,EAAkBF,mBAAQ,WAC9B,GAAKD,EAAY1G,SACjB,OAAO1F,gBAAMoM,EAAYrM,OAAO,KAC/B,CAACqM,IAGJ,OAFAE,qBAAU,kBAAMC,GAAmBJ,EAAcI,EAAgB7G,SAAW,GAAK,CAAC,CAAEG,MAAO0G,EAAgB3G,cAAcC,MAAOC,IAAKyG,EAAgB3G,cAAcE,KAAO,EAAG6F,UAAW,aAAa,CAACY,EAAiBJ,IAElNC,EAAY1G,SAOZ6G,EAAgB7G,SAUd,qCACL,qCACA,cAAC,EAAD,CAASuG,IAAKG,EAAYrM,QAE1B,sCACA,4BAAIwM,EAAgBxM,MAAMoG,gBAdnB,qCACL,qCACA,cAAC,EAAD,CAAS8F,IAAKG,EAAYrM,QAE1B,sCACA,4BAAIwM,EAAgB/L,aAZf,qCACL,qCACA,4BAAI4L,EAAY5L,cCOPgM,MA/Bf,WAAiB,IAAD,EACUC,mBAAS,cADnB,mBACPtB,EADO,KACDuB,EADC,OAEsBD,mBAAsB,IAF5C,mBAEPE,EAFO,KAEKR,EAFL,KAId,OACE,qCACE,4DACA,wEAGA,0CACE,wBAAQS,QAAS,kBAAMF,EAAQ,MAA/B,eACA,wBAAQE,QAAS,kBAAMF,EAAQ,QAA/B,iBACA,wBAAQE,QAAS,kBAAMF,EAAQ,aAA/B,sBACA,wBAAQE,QAAS,kBAAMF,EAAQ,MAA/B,eACA,wBAAQE,QAAS,kBAAMF,EAAQ,eAA/B,wBACA,wBAAQE,QAAS,kBAAMF,EAAQ,QAA/B,iBACA,wBAAQE,QAAS,kBAAMF,EAAQ,SAA/B,kBACA,wBAAQE,QAAS,kBAAMF,EAAQ,qBAA/B,8BACA,yBAAQE,QAAS,kBAAMF,EAAQ,iBAA/B,kBAAqD,IAArD,YACA,wBAAQE,QAAS,kBAAMF,EAAQ,eAA/B,2BAEF,sBAAKf,UAAU,iBAAf,UACE,uBAAOkB,YAAY,gBAAgB9M,MAAOoL,EAAM2B,SAAU,SAAAnH,GAAC,OAAI+G,EAAQ/G,EAAEoH,OAAOhN,UAC/EoL,GAAQwB,EAAWhK,KAAI,SAACqK,EAAG/N,GAAJ,OAAU,8BAAYkM,EAAKhK,MAAM,EAAG6L,EAAEnH,OAAO,sBAAM8F,UAAWqB,EAAErB,UAAnB,SAA+BR,EAAKhK,MAAM6L,EAAEnH,MAAOmH,EAAElH,OAAaqF,EAAKhK,MAAM6L,EAAElH,OAA1G7G,SAE3CkM,GAAQ,cAAC,EAAD,CAAYA,KAAMA,EAAMgB,cAAeA,QC1BtDc,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.8e0fc507.chunk.js","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.apply = exports.infer = exports.unify = exports.combine = exports.substitute = exports.TypeInferenceError = void 0;\nvar language_1 = require(\"language\");\nvar TypeInferenceError = /** @class */ (function (_super) {\n    __extends(TypeInferenceError, _super);\n    function TypeInferenceError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = \"TypeInferenceError\";\n        return _this;\n    }\n    return TypeInferenceError;\n}(Error));\nexports.TypeInferenceError = TypeInferenceError;\nfunction substitute(substitution, arg) {\n    var context = arg;\n    var mappedContext = {};\n    for (var key in context) {\n        mappedContext[key] = apply(context[key], substitution);\n    }\n    return mappedContext;\n}\nexports.substitute = substitute;\n/** Combines substitutions. Applies leftmost substitution first, e.g. combine(a, b).apply(e) == e.apply(a).apply(b) */\nfunction combine() {\n    var substitutions = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        substitutions[_i] = arguments[_i];\n    }\n    if (substitutions.length === 0)\n        return {};\n    if (substitutions.length === 1)\n        return substitutions[0];\n    if (substitutions.length > 2)\n        return combine(substitutions[0], combine.apply(void 0, substitutions.slice(1)));\n    var a = substitutions[0];\n    var b = substitutions[1];\n    var newSubstitution = {};\n    for (var key in a) {\n        newSubstitution[key] = apply(a[key], b);\n    }\n    for (var key in b) {\n        if (!(key in a)) {\n            newSubstitution[key] = b[key];\n        }\n    }\n    return newSubstitution;\n}\nexports.combine = combine;\nfunction unify(type1, type2) {\n    var _a;\n    if (type1 instanceof language_1.TypeVar) {\n        if (contains(type2, type1)) {\n            throw new TypeInferenceError('Contains/occurs check failed with ' + JSON.stringify(type1) + ' and ' + JSON.stringify(type2));\n        }\n        return _a = {}, _a[type1.name] = type2, _a;\n    }\n    if (type2 instanceof language_1.TypeVar) {\n        return unify(type2, type1);\n    }\n    if (type1 instanceof language_1.TypeFuncApp && type2 instanceof language_1.TypeFuncApp) {\n        if (type1.constructorName !== type2.constructorName) {\n            throw new TypeInferenceError('Could not unify type function applications with different constructors \\'' + type1.constructorName + '\\' and \\'' + type2.constructorName + '\\'');\n        }\n        if (type1.args.length !== type2.args.length) {\n            throw new TypeInferenceError('Could not unify type function applications with different argument list lengths ' + JSON.stringify(type1) + ' and ' + JSON.stringify(type2));\n        }\n        var sub = {};\n        for (var i = 0; i < type1.args.length; i++) {\n            sub = combine(unify(apply(type1.args[i], sub), apply(type2.args[i], sub)), sub);\n        }\n        return sub;\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nexports.unify = unify;\n/** a \\ b */\nfunction diff(a, b) {\n    var bset = new Set(b);\n    return a.filter(function (v) { return !bset.has(v); });\n}\nfunction freeVars(type) {\n    if (type instanceof language_1.PolyType) {\n        return diff(freeVars(type.monoType), type.quantifiedVars);\n    }\n    if (type instanceof language_1.TypeVar) {\n        return [type.name];\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return type.args.map(freeVars).reduce(function (acc, cur) { return __spreadArrays(acc, cur); }, []);\n    }\n    if (type) {\n        // type: Context\n        return Object.values(type).map(freeVars).reduce(function (acc, cur) { return __spreadArrays(acc, cur); }, []);\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction generalise(ctx, type) {\n    return new language_1.PolyType(diff(freeVars(type), freeVars(ctx)), type);\n}\nfunction infer(expr, forResponse, ctx) {\n    if (forResponse === void 0) { forResponse = false; }\n    if (ctx === void 0) { ctx = language_1.typeUtils.standardCtx; }\n    var typeCounter = 0;\n    var freshTypeName = function () { return \"t\" + typeCounter++; };\n    if (!forResponse)\n        return _infer(expr, ctx, freshTypeName)[0];\n    try {\n        return {\n            accepted: true,\n            value: _infer(expr, ctx, freshTypeName)[0]\n        };\n    }\n    catch (e) {\n        return {\n            accepted: false,\n            issuePosition: { start: 0, end: 0 },\n            message: e.message\n        };\n    }\n}\nexports.infer = infer;\nfunction _infer(expr, ctx, freshTypeName) {\n    var _a, _b;\n    if (expr instanceof language_1.CharLiteral) {\n        return [inst(new language_1.PolyType([], new language_1.TypeFuncApp('char')), freshTypeName), {}];\n    }\n    if (expr instanceof language_1.NumberLiteral) {\n        return [inst(new language_1.PolyType([], new language_1.TypeFuncApp('number')), freshTypeName), {}];\n    }\n    if (expr instanceof language_1.Var) {\n        var type = ctx[expr.name];\n        if (!type) {\n            throw new TypeInferenceError(expr.name + ' is not in scope');\n        }\n        return [inst(type, freshTypeName), {}];\n    }\n    if (expr instanceof language_1.App) {\n        var _c = _infer(expr.func, ctx, freshTypeName), funcType = _c[0], funcSubstitution = _c[1];\n        var _d = _infer(expr.arg, substitute(funcSubstitution, ctx), freshTypeName), argType = _d[0], argSubstitution = _d[1];\n        var t = new language_1.TypeVar(freshTypeName());\n        var unifiedSubstitution = unify(apply(funcType, argSubstitution), new language_1.TypeFuncApp(\"->\", argType, t));\n        return [apply(t, unifiedSubstitution), combine(funcSubstitution, argSubstitution, unifiedSubstitution)];\n    }\n    if (expr instanceof language_1.Abs) {\n        var t = new language_1.TypeVar(freshTypeName());\n        var _e = _infer(expr.body, __assign(__assign({}, ctx), (_a = {}, _a[expr.param] = new language_1.PolyType([], t), _a)), freshTypeName), bodyType = _e[0], bodySubstitution = _e[1];\n        return [apply(new language_1.TypeFuncApp(\"->\", t, bodyType), bodySubstitution), bodySubstitution];\n    }\n    if (expr instanceof language_1.Let) {\n        var _f = _infer(expr.def, ctx, freshTypeName), defType = _f[0], defSubstitution = _f[1];\n        var _g = _infer(expr.body, __assign(__assign({}, substitute(defSubstitution, ctx)), (_b = {}, _b[expr.param] = generalise(substitute(defSubstitution, ctx), defType), _b)), freshTypeName), bodyType = _g[0], bodySubstitution = _g[1];\n        return [bodyType, combine(defSubstitution, bodySubstitution)];\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction inst(type, freshTypeName, from, to) {\n    if (from === void 0) { from = []; }\n    if (to === void 0) { to = []; }\n    if (type instanceof language_1.TypeVar) {\n        var i = from.indexOf(type.name);\n        return (i === -1) ? type : new language_1.TypeVar(to[i]);\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return new (language_1.TypeFuncApp.bind.apply(language_1.TypeFuncApp, __spreadArrays([void 0, type.constructorName], type.args.map(function (arg) { return inst(arg, freshTypeName, from, to); }))))();\n    }\n    if (type instanceof language_1.PolyType) {\n        return inst(type.monoType, freshTypeName, type.quantifiedVars, type.quantifiedVars.map(freshTypeName));\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nfunction apply(type, substitution) {\n    if (type instanceof language_1.TypeVar) {\n        return type.name in substitution ? substitution[type.name] : type;\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return new (language_1.TypeFuncApp.bind.apply(language_1.TypeFuncApp, __spreadArrays([void 0, type.constructorName], type.args.map(function (arg) { return apply(arg, substitution); }))))();\n    }\n    if (type instanceof language_1.PolyType) {\n        return new language_1.PolyType(type.quantifiedVars, apply(type.monoType, substitution));\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\nexports.apply = apply;\nfunction contains(type, other) {\n    if (type instanceof language_1.TypeVar) {\n        return type.name == other.name;\n    }\n    if (type instanceof language_1.TypeFuncApp) {\n        return type.args.some(function (arg) { return contains(arg, other); });\n    }\n    if (type instanceof language_1.PolyType) {\n        return contains(type.monoType, other) && !type.quantifiedVars.includes(other.name);\n    }\n    // Should be unreachable...\n    throw new Error('Internal error, this should never happen');\n}\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.typeUtils = exports.ParseError = exports.parse = exports.PolyType = exports.TypeFuncApp = exports.TypeVar = exports.Let = exports.Abs = exports.App = exports.Var = exports.NumberLiteral = exports.CharLiteral = void 0;\nvar masala_parser_1 = require(\"@domdomegg/masala-parser\");\nvar CharLiteral = /** @class */ (function () {\n    function CharLiteral(value, pos) {\n        this.value = value;\n        this.pos = pos;\n    }\n    CharLiteral.prototype.toString = function () {\n        return this.value;\n    };\n    return CharLiteral;\n}());\nexports.CharLiteral = CharLiteral;\nvar NumberLiteral = /** @class */ (function () {\n    function NumberLiteral(value, pos) {\n        this.value = value;\n        this.pos = pos;\n    }\n    NumberLiteral.prototype.toString = function () {\n        return this.value.toString();\n    };\n    return NumberLiteral;\n}());\nexports.NumberLiteral = NumberLiteral;\nvar Var = /** @class */ (function () {\n    function Var(name, pos) {\n        this.name = name;\n        this.pos = pos;\n    }\n    Var.prototype.toString = function () {\n        return this.name;\n    };\n    return Var;\n}());\nexports.Var = Var;\nvar App = /** @class */ (function () {\n    function App(fun, arg, pos) {\n        this.func = fun;\n        this.arg = arg;\n        this.pos = pos;\n    }\n    App.prototype.toString = function () {\n        return '(' + this.func.toString() + ' ' + this.arg.toString() + ')';\n    };\n    return App;\n}());\nexports.App = App;\nvar Abs = /** @class */ (function () {\n    function Abs(param, body, pos) {\n        this.param = param;\n        this.body = body;\n        this.pos = pos;\n    }\n    Abs.prototype.toString = function () {\n        return '(\\\\' + this.param + ' -> ' + this.body.toString() + ')';\n    };\n    return Abs;\n}());\nexports.Abs = Abs;\nvar Let = /** @class */ (function () {\n    function Let(param, def, body, pos) {\n        this.param = param;\n        this.def = def;\n        this.body = body;\n        this.pos = pos;\n    }\n    Let.prototype.toString = function () {\n        return '(let ' + this.param + ' = ' + this.def.toString() + ' in ' + this.body.toString() + ')';\n    };\n    return Let;\n}());\nexports.Let = Let;\nvar TypeVar = /** @class */ (function () {\n    function TypeVar(name) {\n        this.name = name;\n    }\n    TypeVar.prototype.toString = function () {\n        return this.name;\n    };\n    return TypeVar;\n}());\nexports.TypeVar = TypeVar;\nvar TypeFuncApp = /** @class */ (function () {\n    function TypeFuncApp(constructorName) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        this.constructorName = constructorName;\n        this.args = args;\n    }\n    TypeFuncApp.prototype.toString = function () {\n        return this.constructorName + (this.args.length ? ' ' : '') + this.args.map(function (a) { return '(' + a.toString() + ')'; }).join(' ');\n    };\n    return TypeFuncApp;\n}());\nexports.TypeFuncApp = TypeFuncApp;\nvar PolyType = /** @class */ (function () {\n    function PolyType(quantifiedVars, monoType) {\n        this.quantifiedVars = quantifiedVars;\n        this.monoType = monoType;\n    }\n    PolyType.prototype.toString = function () {\n        return this.quantifiedVars.map(function (v) { return '∀' + v; }).join('') + ': ' + this.monoType.toString();\n    };\n    return PolyType;\n}());\nexports.PolyType = PolyType;\n/* Type utilities */\n// Utilities which make creating types easier\nvar number = new TypeFuncApp('number');\nvar char = new TypeFuncApp('char');\nvar boolean = new TypeFuncApp('boolean');\nvar f = function (one, two) {\n    var extra = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        extra[_i - 2] = arguments[_i];\n    }\n    if (extra.length === 0)\n        return new TypeFuncApp('->', one, two);\n    return new TypeFuncApp('->', one, f.apply(void 0, __spreadArrays([two, extra[0]], extra.slice(1))));\n};\nvar list = function (monoType) { return new TypeFuncApp('[]', monoType); };\nvar tuple = function () {\n    var monoTypes = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        monoTypes[_i] = arguments[_i];\n    }\n    if (monoTypes.length <= 1)\n        throw new Error('Tuple has too few elements, minimum of 2 but given ' + monoTypes.length);\n    if (monoTypes.length > 8)\n        throw new Error('Tuple has too many elements, maximum of 8 but given ' + monoTypes.length);\n    return new (TypeFuncApp.bind.apply(TypeFuncApp, __spreadArrays([void 0, ','.repeat(monoTypes.length - 1)], monoTypes)))();\n};\nvar maybe = function (monoType) { return new TypeFuncApp('Maybe', monoType); };\nvar either = function (left, right) { return new TypeFuncApp('Either', left, right); };\nvar a = new TypeVar('a');\nvar b = new TypeVar('b');\nvar c = new TypeVar('c');\nvar d = new TypeVar('d');\nvar pt = function (mt) { return new PolyType([], mt); };\n// Set up some basic things so the langauge is interesting\nvar standardCtx = {\n    // Arithmetic\n    '+': pt(f(number, number, number)),\n    '*': pt(f(number, number, number)),\n    '-': pt(f(number, number, number)),\n    '/': pt(f(number, number, number)),\n    '%': pt(f(number, number, number)),\n    'negate': pt(f(number, number)),\n    'abs': pt(f(number, number)),\n    'signum': pt(f(number, number)),\n    'even': pt(f(number, boolean)),\n    'odd': pt(f(number, boolean)),\n    // Booleans\n    'not': pt(f(boolean, boolean)),\n    '&&': pt(f(boolean, boolean, boolean)),\n    '||': pt(f(boolean, boolean, boolean)),\n    'True': pt(boolean),\n    'False': pt(boolean),\n    // Example variables\n    'myNumber': pt(number),\n    'myBoolean': pt(boolean),\n    // Lists\n    '[]': new PolyType(['a'], list(a)),\n    ':': new PolyType(['a'], f(a, list(a), list(a))),\n    'cons': new PolyType(['a'], f(a, list(a), list(a))),\n    '++': new PolyType(['a'], f(list(a), list(a), list(a))),\n    'head': new PolyType(['a'], f(list(a), a)),\n    'last': new PolyType(['a'], f(list(a), a)),\n    'tail': new PolyType(['a'], f(list(a), list(a))),\n    'init': new PolyType(['a'], f(list(a), list(a))),\n    'uncons': new PolyType(['a'], f(list(a), maybe(tuple(a, list(a))))),\n    'null': new PolyType(['a'], f(list(a), boolean)),\n    'length': new PolyType(['a'], f(list(a), number)),\n    'map': new PolyType(['a', 'b'], f(f(a, b), list(a), list(b))),\n    'reverse': new PolyType(['a'], f(list(a), list(a))),\n    'intersperse': new PolyType(['a'], f(a, list(a), list(a))),\n    'intercalate': new PolyType(['a'], f(list(a), list(list(a)), list(a))),\n    'transpose': new PolyType(['a'], f(list(list(a)), list(list((a))))),\n    'subsequences': new PolyType(['a'], f(list(a), list(list((a))))),\n    'permutations': new PolyType(['a'], f(list(a), list(list((a))))),\n    'foldl': new PolyType(['a'], f(f(b, a, b), b, list(a), b)),\n    'foldl\\'': new PolyType(['a'], f(f(b, a, b), b, list(a), b)),\n    'foldl1': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n    'foldl1\\'': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n    'foldr': new PolyType(['a'], f(f(a, b, b), b, list(a), b)),\n    'foldr1': new PolyType(['a'], f(f(a, a, a), list(a), a)),\n    'concat': new PolyType(['a'], f(list(list(a)), list(a))),\n    'concatMap': new PolyType(['a'], f(f(a, list(a)), list(a), list(b))),\n    'and': pt(f(list(boolean), boolean)),\n    'or': pt(f(list(boolean), boolean)),\n    'any': new PolyType(['a'], f(f(a, boolean), list(a), boolean)),\n    'all': new PolyType(['a'], f(f(a, boolean), list(a), boolean)),\n    'sum': pt(f(list(number), number)),\n    'product': pt(f(list(number), number)),\n    'maximum': pt(f(list(number), number)),\n    'minimum': pt(f(list(number), number)),\n    'take': new PolyType(['a'], f(number, list(a), list(a))),\n    'drop': new PolyType(['a'], f(number, list(a), list(a))),\n    'splitAt': new PolyType(['a'], f(number, list(a), tuple(list(a), list(a)))),\n    'takeWhile': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n    'dropWhile': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n    'elem': new PolyType(['a'], f(a, list(a), boolean)),\n    'notElem': new PolyType(['a'], f(a, list(a), boolean)),\n    'lookup': new PolyType(['a', 'b'], f(a, list(tuple(a, b)), maybe(b))),\n    'find': new PolyType(['a'], f(f(a, boolean), list(a), maybe(a))),\n    'filter': new PolyType(['a'], f(f(a, boolean), list(a), list(a))),\n    'partition': new PolyType(['a'], f(f(a, boolean), list(a), tuple(list(a), list(a)))),\n    '!!': new PolyType(['a'], f(list(a), number, a)),\n    'zip': new PolyType(['a', 'b'], f(list(a), list(b), list(tuple(a, b)))),\n    'zipWith': new PolyType(['a', 'b', 'c'], f(f(a, b, c), list(a), list(b), list(c))),\n    'unzip': new PolyType(['a', 'b'], f(list(tuple(a, b)), tuple(list(a), list(b)))),\n    'nub': new PolyType(['a'], f(list(a), list(a))),\n    'delete': new PolyType(['a'], f(a, list(a), list(a))),\n    '\\\\\\\\': new PolyType(['a'], f(list(a), list(a), list(a))),\n    'union': new PolyType(['a'], f(list(a), list(a), list(a))),\n    'intersect': new PolyType(['a'], f(list(a), list(a), list(a))),\n    'sort': new PolyType(['a'], f(list(a), list(a))),\n    // Tuples\n    ',': new PolyType(['a', 'b'], f(a, b, tuple(a, b))),\n    ',,': new PolyType(['a', 'b', 'c'], f(a, b, c, tuple(a, b, c))),\n    ',,,': new PolyType(['a', 'b', 'c', 'd'], f(a, b, c, d, tuple(a, b, c, d))),\n    'fst': new PolyType(['a', 'b'], f(tuple(a, b), a)),\n    'snd': new PolyType(['a', 'b'], f(tuple(a, b), b)),\n    'curry': new PolyType(['a', 'b', 'c'], f(f(tuple(a, b), c), a, b, c)),\n    'uncurry': new PolyType(['a', 'b', 'c'], f(f(a, b, c), tuple(a, b), c)),\n    // Maybe\n    'Just': new PolyType(['a'], f(a, maybe(a))),\n    'Nothing': new PolyType(['a'], maybe(a)),\n    // Either\n    'Left': new PolyType(['a', 'b'], f(a, either(a, b))),\n    'Right': new PolyType(['a', 'b'], f(b, either(a, b))),\n    // Id\n    'id': new PolyType(['a'], f(a, a)),\n};\n/* Parser */\n// expr ::= identifier # var\n//        | ( \\ identifier -> expr ) # abs\n//        | ( expr )\n//        | expr expr # app\n//        | ( let identifier = expr in expr ) # let\n// expr ::= identifier expr' # var\n//        | ( \\ identifier -> expr ) expr' # abs\n//        | ( expr ) expr'\n//        | ( let identifier = expr in expr ) expr' # let\n// expr' ::= expr A' | eps # app\nvar ParseError = /** @class */ (function (_super) {\n    __extends(ParseError, _super);\n    function ParseError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = \"ParseError\";\n        return _this;\n    }\n    return ParseError;\n}(Error));\nexports.ParseError = ParseError;\nvar genlex = new masala_parser_1.GenLex();\nvar identifier = genlex.tokenize(masala_parser_1.C.charIn('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*+-/%<>^:[]_|&,').rep().map(function (t) { return t.join(); }), 'identifier');\nvar charLiteral = genlex.tokenize(masala_parser_1.C.charLiteral(), 'char');\nvar stringLiteral = genlex.tokenize(masala_parser_1.C.stringLiteral(), 'string');\nvar numberLiteral = genlex.tokenize(masala_parser_1.N.number(), 'number');\nvar backslash = genlex.tokenize(masala_parser_1.C.char('\\\\'), 'backslash');\nvar arrow = genlex.tokenize(masala_parser_1.C.string('->'), 'arrow');\nvar lparen = genlex.tokenize(masala_parser_1.C.char('('), 'lparen');\nvar rparen = genlex.tokenize(masala_parser_1.C.char(')'), 'rparen');\nvar letTok = genlex.tokenize(masala_parser_1.C.string('let'), 'let');\nvar equal = genlex.tokenize(masala_parser_1.C.char('='), 'equal');\nvar inTok = genlex.tokenize(masala_parser_1.C.string('in'), 'in');\nvar expression1 = function () {\n    return masala_parser_1.F.try(LET_())\n        .or(masala_parser_1.F.try(ABS_()))\n        .or(masala_parser_1.F.try(expression2()));\n};\nvar expression2 = function () {\n    return masala_parser_1.F.try(optApp(LEAF()))\n        .or(masala_parser_1.F.try(optApp(ABS())))\n        .or(masala_parser_1.F.try(optApp(LET())))\n        .or(masala_parser_1.F.try(optApp(PAR())));\n};\nvar expression3 = function () {\n    return masala_parser_1.F.try(LEAF())\n        .or(masala_parser_1.F.try(ABS()))\n        .or(masala_parser_1.F.try(LET()))\n        .or(masala_parser_1.F.try(PAR()));\n};\nvar toCharArray = function (string, r) {\n    var chars = string.split('');\n    var pos = getPos(r);\n    var expr = new Var('[]', { start: pos.end - 1, end: pos.end });\n    for (var i = chars.length - 1; i >= 0; i--) {\n        var charPos = { start: pos.start + 1 + i, end: pos.start + 2 + i };\n        expr = new App(new App(new Var(':', charPos), new CharLiteral(chars[i], charPos), charPos), expr, { start: pos.start + 1 + i, end: pos.end - 1 });\n    }\n    expr.pos.start = pos.start;\n    expr.pos.end = pos.end;\n    return expr;\n};\nvar getPos = function (r) {\n    var offset = r.getOffset() - 1;\n    var start = r.input.location(offset);\n    var guessedEnd = r.input.location(offset + 1);\n    var rawString = r.input.source.input.source.slice(start, guessedEnd);\n    var end = guessedEnd - (rawString.length - rawString.trimEnd().length);\n    return { start: start, end: end };\n};\nvar expandPos = function (v, r) {\n    var rawString = r.input.source.input.source;\n    v.pos.end += rawString.slice(v.pos.end).indexOf(')') + 1;\n    v.pos.start = rawString.slice(0, v.pos.start).lastIndexOf('(');\n    return v;\n};\n// We have to SHOUT as var and let are restricted keywords in JavaScript\nvar LEAF = function () { return masala_parser_1.F.try(numberLiteral.map(function (value, r) { return new NumberLiteral(value, getPos(r)); })).or(masala_parser_1.F.try(stringLiteral.map(toCharArray))).or(masala_parser_1.F.try(charLiteral.map(function (value, r) { return new CharLiteral(value, getPos(r)); }))).or(masala_parser_1.F.try(identifier.map(function (value, r) { return new Var(value, getPos(r)); }))); };\nvar ABS = function () { return lparen.drop().then(ABS_()).then(rparen.drop()).single().map(expandPos); };\nvar ABS_ = function () { return backslash.map(function (v, r) { return r.location() - 1; }).then(identifier).then(arrow.drop()).then(masala_parser_1.F.lazy(expression2)).map(function (tuple, r) { return new Abs(tuple.at(1), tuple.at(2), { start: tuple.at(0), end: r.location() }); }); };\nvar PAR = function () { return lparen.drop().then(masala_parser_1.F.lazy(expression2)).then(rparen.drop()).single().map(expandPos); };\nvar LET = function () { return lparen.drop().then(LET_()).then(rparen.drop()).single().map(expandPos); };\nvar LET_ = function () { return letTok.map(function (v, r) { return getPos(r).start; }).then(identifier).then(equal.drop()).then(masala_parser_1.F.lazy(expression2)).then(inTok.drop()).then(masala_parser_1.F.lazy(expression2)).map(function (tuple, r) { return new Let(tuple.at(1), tuple.at(2), tuple.at(3), { start: tuple.at(0), end: r.location() }); }); };\nvar optApp = function (parser) { return parser.then(expressionPrime()).array().map(nestLeft); };\nvar expressionPrime = function () { return masala_parser_1.F.lazy(expression3).optrep(); };\nvar nestLeft = function (v) { return v.reduce(function (prev, cur) { return new App(prev, cur, { start: prev.pos.start, end: cur.pos.end }); }); };\nvar parser = genlex.use(expression1().then(masala_parser_1.F.eos().drop()).single());\nfunction parse(code, forResponse) {\n    if (forResponse === void 0) { forResponse = false; }\n    var response = parser.parse(masala_parser_1.Streams.ofString(code));\n    if (forResponse) {\n        if (response.isAccepted())\n            return { accepted: true, value: response.value };\n        return { accepted: false, issuePosition: { start: response.location(), end: code.length }, message: 'Failed to parse' };\n    }\n    if (response.isAccepted())\n        return response.value;\n    throw new ParseError('Failed to parse:\\n\\t' + code + '\\n\\t' + ' '.repeat(response.location()) + '^');\n}\nexports.parse = parse;\nvar typeUtils = { number: number, char: char, boolean: boolean, f: f, list: list, tuple: tuple, maybe: maybe, either: either, a: a, b: b, c: c, d: d, pt: pt, standardCtx: standardCtx };\nexports.typeUtils = typeUtils;\n","import React, { ReactNode } from 'react';\nimport { Expr, Var, App, Abs, Let, NumberLiteral, CharLiteral } from 'language'\n\nfunction ASTView({ ast }: { ast: Expr }) {\n    return <div className=\"ast-view\"><NodeView node={ast} /></div>\n}\n\nfunction NodeView({ node }: { node: Expr }) {\n    if (node instanceof CharLiteral || node instanceof NumberLiteral) {\n        return <NodeWrapperView>{node.value}</NodeWrapperView>;\n    }\n\n    if (node instanceof Var) {\n        return <NodeWrapperView>{node.name}</NodeWrapperView>;\n    }\n\n    if (node instanceof App) {\n        return <>\n            <NodeWrapperView><span className=\"sans-serif\">Function application</span></NodeWrapperView>\n            <NodeChildView><NodeView node={node.func}/></NodeChildView>\n            <NodeChildView><NodeView node={node.arg}/></NodeChildView>\n        </>;\n    }\n\n    if (node instanceof Abs) {\n        return <>\n            <NodeWrapperView>λ{node.param}</NodeWrapperView>\n            <NodeChildView symbol='->'><NodeView node={node.body}/></NodeChildView>\n        </>\n    }\n\n    if (node instanceof Let) {\n        return <>\n            <NodeWrapperView>let {node.param}</NodeWrapperView>\n            <NodeChildView symbol='='><NodeView node={node.def}/></NodeChildView>\n            <NodeChildView symbol='in'><NodeView node={node.body}/></NodeChildView>\n        </>\n    }\n\n    throw new Error('Attempted to display a node of invalid type ' + typeof node);\n}\n\nfunction NodeWrapperView({ children }: { children: ReactNode }) {\n    return <div className=\"ast-node\">{children}</div>;\n}\n\nfunction NodeChildView({ children, symbol }: { children: ReactNode, symbol?: string }) {\n    return <div className=\"ast-child\" data-symbol={symbol}>{children}</div>\n}\n\nexport default ASTView;","import React, { useMemo, useEffect } from 'react';\nimport { parse } from 'language'\nimport { infer } from 'algorithm-w'\nimport ASTView from './ASTView';\n\nexport interface Highlight {\n  start: number;\n  end: number;\n  className: string;\n}\n\nfunction ResultView({ code, setHighlights }: { code: string, setHighlights: (h: Highlight[]) => void }) {\n  // Parse the code, highlighting any errors\n  const parseResult = useMemo(() => {\n    return parse(code, true);\n  }, [code]);\n  useEffect(() => setHighlights(parseResult.accepted ? [] : [{ start: parseResult.issuePosition.start, end: parseResult.issuePosition.end || 0, className: 'error' }]), [parseResult, setHighlights]);\n\n  // Infer the types, highlighting any errors\n  const inferenceResult = useMemo(() => {\n    if (!parseResult.accepted) return;\n    return infer(parseResult.value, true);\n  }, [parseResult])!;\n  useEffect(() => inferenceResult && setHighlights(inferenceResult.accepted ? [] : [{ start: inferenceResult.issuePosition.start, end: inferenceResult.issuePosition.end || 0, className: 'error' }]), [inferenceResult, setHighlights]);\n\n  if (!parseResult.accepted) {\n    return <>\n      <h2>AST</h2>\n      <p>{parseResult.message}</p>\n    </>;\n  }\n\n  if (!inferenceResult.accepted) {\n    return <>\n      <h2>AST</h2>\n      <ASTView ast={parseResult.value} />\n\n      <h2>Type</h2>\n      <p>{inferenceResult.message}</p>\n    </>;\n  }\n\n  return <>\n    <h2>AST</h2>\n    <ASTView ast={parseResult.value} />\n\n    <h2>Type</h2>\n    <p>{inferenceResult.value.toString()}</p>\n  </>;\n}\n\nexport default ResultView;","import React, { useState } from 'react';\nimport './Main.css';\nimport ResultView, { Highlight } from './ResultView';\n\nfunction Main() {\n  const [code, setCode] = useState('map not []');\n  const [highlights, setHighlights] = useState<Highlight[]>([]);\n\n  return (\n    <>\n      <h1>interactive type inference</h1>\n      <h2>\n        Play with algorithm W in your browser.\n      </h2>\n      <h2>Samples:\n        <button onClick={() => setCode('4')}>4</button>\n        <button onClick={() => setCode('not')}>not</button>\n        <button onClick={() => setCode('not True')}>not True</button>\n        <button onClick={() => setCode('+')}>+</button>\n        <button onClick={() => setCode('map not []')}>map not []</button>\n        <button onClick={() => setCode('fst')}>fst</button>\n        <button onClick={() => setCode('Just')}>Just</button>\n        <button onClick={() => setCode('let x = 3 in + x')}>let x = 3 in + x</button>\n        <button onClick={() => setCode('\\\\x -> / x 2')}>\\x -{'>'} / x 2</button>\n        <button onClick={() => setCode('cons 23 []')}>cons 23 []</button>\n      </h2>\n      <div className='code-container'>\n        <input placeholder=\"Enter code...\" value={code} onChange={e => setCode(e.target.value)} />\n        {code && highlights.map((h, i) => <p key={i}>{code.slice(0, h.start)}<span className={h.className}>{code.slice(h.start, h.end)}</span>{code.slice(h.end)}</p>)}\n      </div>\n      {code && <ResultView code={code} setHighlights={setHighlights} />}\n    </>\n  );\n}\n\nexport default Main;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Main from './Main';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Main />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}