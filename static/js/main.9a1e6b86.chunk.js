(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{1:function(n,e,t){"use strict";var r=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.typeUtils=e.ParseError=e.parse=e.PolyType=e.TypeFuncApp=e.TypeVar=e.Let=e.Abs=e.App=e.Var=e.NumberLiteral=e.CharLiteral=void 0;var i=t(25),a=function(){function n(n){this.value=n}return n.prototype.toString=function(){return this.value},n}();e.CharLiteral=a;var u=function(){function n(n){this.value=n}return n.prototype.toString=function(){return this.value.toString()},n}();e.NumberLiteral=u;var c=function(){function n(n){this.name=n}return n.prototype.toString=function(){return this.name},n}();e.Var=c;var s=function(){function n(n,e){this.func=n,this.arg=e}return n.prototype.toString=function(){return"("+this.func.toString()+" "+this.arg.toString()+")"},n}();e.App=s;var p=function(){function n(n,e){this.param=n,this.body=e}return n.prototype.toString=function(){return"(\\"+this.param+" -> "+this.body.toString()+")"},n}();e.Abs=p;var f=function(){function n(n,e,t){this.param=n,this.def=e,this.body=t}return n.prototype.toString=function(){return"(let "+this.param+" = "+this.def.toString()+" in "+this.body.toString()+")"},n}();e.Let=f;var l=function(){function n(n){this.name=n}return n.prototype.toString=function(){return this.name},n}();e.TypeVar=l;var h=function(){function n(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];this.constructorName=n,this.args=e}return n.prototype.toString=function(){return this.constructorName+(this.args.length?" ":"")+this.args.map((function(n){return"("+n.toString()+")"})).join(" ")},n}();e.TypeFuncApp=h;var y=function(){function n(n,e){this.quantifiedVars=n,this.monoType=e}return n.prototype.toString=function(){return this.quantifiedVars.map((function(n){return"\u2200"+n})).join("")+": "+this.monoType.toString()},n}();e.PolyType=y;var w=new h("number"),d=new h("char"),m=new h("boolean"),b=function n(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return 0===r.length?new h("->",e,t):new h("->",e,n.apply(void 0,o([t,r[0]],r.slice(1))))},g=function(n){return new h("[]",n)},v=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length<=1)throw new Error("Tuple has too few elements, minimum of 2 but given "+n.length);if(n.length>8)throw new Error("Tuple has too many elements, maximum of 8 but given "+n.length);return new(h.bind.apply(h,o([void 0,",".repeat(n.length-1)],n)))},T=function(n){return new h("Maybe",n)},j=function(n,e){return new h("Either",n,e)},O=new l("a"),F=new l("b"),A=new l("c"),x=new l("d"),S=function(n){return new y([],n)},_={"+":S(b(w,w,w)),"*":S(b(w,w,w)),"-":S(b(w,w,w)),"/":S(b(w,w,w)),"%":S(b(w,w,w)),negate:S(b(w,w)),abs:S(b(w,w)),signum:S(b(w,w)),even:S(b(w,m)),odd:S(b(w,m)),not:S(b(m,m)),"&&":S(b(m,m,m)),"||":S(b(m,m,m)),True:S(m),False:S(m),myNumber:S(w),myBoolean:S(m),"[]":new y(["a"],g(O)),":":new y(["a"],b(O,g(O),g(O))),cons:new y(["a"],b(O,g(O),g(O))),"++":new y(["a"],b(g(O),g(O),g(O))),head:new y(["a"],b(g(O),O)),last:new y(["a"],b(g(O),O)),tail:new y(["a"],b(g(O),g(O))),init:new y(["a"],b(g(O),g(O))),uncons:new y(["a"],b(g(O),T(v(O,g(O))))),null:new y(["a"],b(g(O),m)),length:new y(["a"],b(g(O),w)),map:new y(["a","b"],b(b(O,F),g(O),g(F))),reverse:new y(["a"],b(g(O),g(O))),intersperse:new y(["a"],b(O,g(O),g(O))),intercalate:new y(["a"],b(g(O),g(g(O)),g(O))),transpose:new y(["a"],b(g(g(O)),g(g(O)))),subsequences:new y(["a"],b(g(O),g(g(O)))),permutations:new y(["a"],b(g(O),g(g(O)))),foldl:new y(["a"],b(b(F,O,F),F,g(O),F)),"foldl'":new y(["a"],b(b(F,O,F),F,g(O),F)),foldl1:new y(["a"],b(b(O,O,O),g(O),O)),"foldl1'":new y(["a"],b(b(O,O,O),g(O),O)),foldr:new y(["a"],b(b(O,F,F),F,g(O),F)),foldr1:new y(["a"],b(b(O,O,O),g(O),O)),concat:new y(["a"],b(g(g(O)),g(O))),concatMap:new y(["a"],b(b(O,g(O)),g(O),g(F))),and:S(b(g(m),m)),or:S(b(g(m),m)),any:new y(["a"],b(b(O,m),g(O),m)),all:new y(["a"],b(b(O,m),g(O),m)),sum:S(b(g(w),w)),product:S(b(g(w),w)),maximum:S(b(g(w),w)),minimum:S(b(g(w),w)),take:new y(["a"],b(w,g(O),g(O))),drop:new y(["a"],b(w,g(O),g(O))),splitAt:new y(["a"],b(w,g(O),v(g(O),g(O)))),takeWhile:new y(["a"],b(b(O,m),g(O),g(O))),dropWhile:new y(["a"],b(b(O,m),g(O),g(O))),elem:new y(["a"],b(O,g(O),m)),notElem:new y(["a"],b(O,g(O),m)),lookup:new y(["a","b"],b(O,g(v(O,F)),T(F))),find:new y(["a"],b(b(O,m),g(O),T(O))),filter:new y(["a"],b(b(O,m),g(O),g(O))),partition:new y(["a"],b(b(O,m),g(O),v(g(O),g(O)))),"!!":new y(["a"],b(g(O),w,O)),zip:new y(["a","b"],b(g(O),g(F),g(v(O,F)))),zipWith:new y(["a","b","c"],b(b(O,F,A),g(O),g(F),g(A))),unzip:new y(["a","b"],b(g(v(O,F)),v(g(O),g(F)))),nub:new y(["a"],b(g(O),g(O))),delete:new y(["a"],b(O,g(O),g(O))),"\\\\":new y(["a"],b(g(O),g(O),g(O))),union:new y(["a"],b(g(O),g(O),g(O))),intersect:new y(["a"],b(g(O),g(O),g(O))),sort:new y(["a"],b(g(O),g(O))),",":new y(["a","b"],b(O,F,v(O,F))),",,":new y(["a","b","c"],b(O,F,A,v(O,F,A))),",,,":new y(["a","b","c","d"],b(O,F,A,x,v(O,F,A,x))),fst:new y(["a","b"],b(v(O,F),O)),snd:new y(["a","b"],b(v(O,F),F)),curry:new y(["a","b","c"],b(b(v(O,F),A),O,F,A)),uncurry:new y(["a","b","c"],b(b(O,F,A),v(O,F),A)),Just:new y(["a"],b(O,T(O))),Nothing:new y(["a"],T(O)),Left:new y(["a","b"],b(O,j(O,F))),Right:new y(["a","b"],b(F,j(O,F))),id:new y(["a"],b(O,O))},C=function(n){function e(e){var t=n.call(this,e)||this;return t.name="ParseError",t}return r(e,n),e}(Error);e.ParseError=C;var k=new i.GenLex,E=k.tokenize(i.C.charIn("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*+-/%<>^:[]_|&,").rep().map((function(n){return n.join()})),"identifier"),P=k.tokenize(i.C.charLiteral(),"char"),N=k.tokenize(i.C.stringLiteral(),"string"),V=k.tokenize(i.N.number(),"number"),z=k.tokenize(i.C.char("\\"),"backslash"),L=k.tokenize(i.C.string("->"),"arrow"),I=k.tokenize(i.C.char("("),"lparen"),J=k.tokenize(i.C.char(")"),"rparen"),q=k.tokenize(i.C.string("let"),"let"),M=k.tokenize(i.C.char("="),"equal"),W=k.tokenize(i.C.string("in"),"in"),U=function(){return i.F.try(Y(R())).or(i.F.try(Y(D()))).or(i.F.try(Y(Q()))).or(i.F.try(Y(K())))},B=function(){return i.F.try(R()).or(i.F.try(D())).or(i.F.try(Q())).or(i.F.try(K()))},G=function(n){for(var e=n.split(""),t=new c("[]");e.length;)t=new s(new s(new c(":"),new a(e.pop())),t);return t},R=function(){return i.F.try(V.map((function(n){return new u(n)}))).or(i.F.try(N.map(G))).or(i.F.try(P.map((function(n){return new a(n)})))).or(i.F.try(E.map((function(n){return new c(n)}))))},D=function(){return I.drop().then(H()).then(J.drop()).single()},H=function(){return z.drop().then(E).then(L.drop()).then(i.F.lazy(U)).map((function(n){return new p(n.at(0),n.at(1))}))},K=function(){return I.drop().then(i.F.lazy(U)).then(J.drop()).single()},Q=function(){return I.drop().then(X()).then(J.drop()).single()},X=function(){return q.drop().then(E).then(M.drop()).then(i.F.lazy(U)).then(W.drop()).then(i.F.lazy(U)).map((function(n){return new f(n.at(0),n.at(1),n.at(2))}))},Y=function(n){return n.then(Z()).array().map($)},Z=function(){return i.F.lazy(B).optrep()},$=function(n){return n.reduce((function(n,e){return new s(n,e)}))},nn=k.use(i.F.try(X()).or(i.F.try(H())).or(i.F.try(U())).then(i.F.eos().drop()).single());e.parse=function(n,e){void 0===e&&(e=!1);var t=nn.parse(i.Streams.ofString(n));if(e)return t;if(t.isAccepted())return t.value;throw new C("Failed to parse:\n\t"+n+"\n\t"+" ".repeat(t.location())+"^")};var en={number:w,char:d,boolean:m,f:b,list:g,tuple:v,maybe:T,either:j,a:O,b:F,c:A,d:x,pt:S,standardCtx:_};e.typeUtils=en},13:function(n,e,t){"use strict";var r=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},i=this&&this.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),o=0;for(e=0;e<t;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.apply=e.infer=e.unify=e.combine=e.substitute=e.TypeInferenceError=void 0;var a=t(1),u=function(n){function e(e){var t=n.call(this,e)||this;return t.name="TypeInferenceError",t}return r(e,n),e}(Error);function c(n,e){var t=e,r={};for(var o in t)r[o]=w(t[o],n);return r}function s(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)return{};if(1===n.length)return n[0];if(n.length>2)return s(n[0],s.apply(void 0,n.slice(1)));var t=n[0],r=n[1],o={};for(var i in t)o[i]=w(t[i],r);for(var i in r)i in t||(o[i]=r[i]);return o}function p(n,e){var t;if(n instanceof a.TypeVar){if(d(e,n))throw new u("Contains/occurs check failed with "+JSON.stringify(n)+" and "+JSON.stringify(e));return(t={})[n.name]=e,t}if(e instanceof a.TypeVar)return p(e,n);if(n instanceof a.TypeFuncApp&&e instanceof a.TypeFuncApp){if(n.constructorName!==e.constructorName)throw new u("Could not unify type function applications with different constructors '"+n.constructorName+"' and '"+e.constructorName+"'");if(n.args.length!==e.args.length)throw new u("Could not unify type function applications with different argument list lengths "+JSON.stringify(n)+" and "+JSON.stringify(e));for(var r={},o=0;o<n.args.length;o++)r=s(p(w(n.args[o],r),w(e.args[o],r)),r);return r}throw new Error("Internal error, this should never happen")}function f(n,e){var t=new Set(e);return n.filter((function(n){return!t.has(n)}))}function l(n){if(n instanceof a.PolyType)return f(l(n.monoType),n.quantifiedVars);if(n instanceof a.TypeVar)return[n.name];if(n instanceof a.TypeFuncApp)return n.args.map(l).reduce((function(n,e){return i(n,e)}),[]);if(n)return Object.values(n).map(l).reduce((function(n,e){return i(n,e)}),[]);throw new Error("Internal error, this should never happen")}function h(n,e,t){var r,i;if(n instanceof a.CharLiteral)return[y(new a.PolyType([],new a.TypeFuncApp("char")),t),{}];if(n instanceof a.NumberLiteral)return[y(new a.PolyType([],new a.TypeFuncApp("number")),t),{}];if(n instanceof a.Var){var d=e[n.name];if(!d)throw new u(n.name+" is not in scope");return[y(d,t),{}]}if(n instanceof a.App){var m=h(n.func,e,t),b=m[0],g=m[1],v=h(n.arg,c(g,e),t),T=v[0],j=v[1],O=new a.TypeVar(t()),F=p(w(b,j),new a.TypeFuncApp("->",T,O));return[w(O,F),s(g,j,F)]}if(n instanceof a.Abs){O=new a.TypeVar(t());var A=h(n.body,o(o({},e),((r={})[n.param]=new a.PolyType([],O),r)),t),x=A[0],S=A[1];return[w(new a.TypeFuncApp("->",O,x),S),S]}if(n instanceof a.Let){var _=h(n.def,e,t),C=_[0],k=_[1],E=h(n.body,o(o({},c(k,e)),((i={})[n.param]=function(n,e){return new a.PolyType(f(l(e),l(n)),e)}(c(k,e),C),i)),t);return[x=E[0],s(k,S=E[1])]}throw new Error("Internal error, this should never happen")}function y(n,e,t,r){if(void 0===t&&(t=[]),void 0===r&&(r=[]),n instanceof a.TypeVar){var o=t.indexOf(n.name);return-1===o?n:new a.TypeVar(r[o])}if(n instanceof a.TypeFuncApp)return new(a.TypeFuncApp.bind.apply(a.TypeFuncApp,i([void 0,n.constructorName],n.args.map((function(n){return y(n,e,t,r)})))));if(n instanceof a.PolyType)return y(n.monoType,e,n.quantifiedVars,n.quantifiedVars.map(e));throw new Error("Internal error, this should never happen")}function w(n,e){if(n instanceof a.TypeVar)return n.name in e?e[n.name]:n;if(n instanceof a.TypeFuncApp)return new(a.TypeFuncApp.bind.apply(a.TypeFuncApp,i([void 0,n.constructorName],n.args.map((function(n){return w(n,e)})))));if(n instanceof a.PolyType)return new a.PolyType(n.quantifiedVars,w(n.monoType,e));throw new Error("Internal error, this should never happen")}function d(n,e){if(n instanceof a.TypeVar)return n.name==e.name;if(n instanceof a.TypeFuncApp)return n.args.some((function(n){return d(n,e)}));if(n instanceof a.PolyType)return d(n.monoType,e)&&!n.quantifiedVars.includes(e.name);throw new Error("Internal error, this should never happen")}e.TypeInferenceError=u,e.substitute=c,e.combine=s,e.unify=p,e.infer=function(n,e){void 0===e&&(e=a.typeUtils.standardCtx);var t=0;return h(n,e,(function(){return"t"+t++}))[0]},e.apply=w},24:function(n,e,t){},34:function(n,e,t){"use strict";t.r(e);var r=t(0),o=t(2),i=t.n(o),a=t(17),u=t.n(a),c=t(18),s=(t(24),t(1)),p=t(13);var f=function(){var n=Object(o.useState)("map not []"),e=Object(c.a)(n,2),t=e[0],i=e[1],a="Failed to parse",u="Failed to infer type";try{if(!((a=Object(s.parse)(t))instanceof s.CharLiteral)&&!(a instanceof s.NumberLiteral)&&!(a instanceof s.Var)&&!(a instanceof s.App)&&!(a instanceof s.Abs)&&!(a instanceof s.Let))throw new Error("Not a valid expression");u=Object(p.infer)(a)}catch(f){f.name===s.ParseError.name?a=f.message:f.name===p.TypeInferenceError.name?u=f.message:a="Not a valid expression: "+JSON.stringify(f.message)}return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:"interactive type inference"}),Object(r.jsx)("h2",{children:"Play with algorithm W in your browser."}),Object(r.jsxs)("h2",{children:["Samples:",Object(r.jsx)("button",{onClick:function(){return i("4")},children:"4"}),Object(r.jsx)("button",{onClick:function(){return i("+")},children:"+"}),Object(r.jsx)("button",{onClick:function(){return i("map not []")},children:"map not []"}),Object(r.jsx)("button",{onClick:function(){return i("fst")},children:"fst"}),Object(r.jsx)("button",{onClick:function(){return i("Just")},children:"Just"}),Object(r.jsx)("button",{onClick:function(){return i("let x = 3 in + x")},children:"let x = 3 in + x"})]}),Object(r.jsx)("textarea",{placeholder:"Enter code here...",value:t,onChange:function(n){return i(n.target.value)}}),Object(r.jsx)("h2",{children:"AST"}),Object(r.jsx)("p",{children:a.toString()}),Object(r.jsx)("h2",{children:"Type"}),Object(r.jsx)("p",{children:u.toString()})]})};u.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(f,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.9a1e6b86.chunk.js.map